

enum TrackFilters {
   kBasicCut=0,
   kPIDopen,
   kPrefilterCut,
   kNTrackFilters
};
enum MCFilters {
  kJpsiInclusive=0,
  kJpsiNonPrompt,
  kJpsiPrompt,
  kJpsiRadiative,
  kJpsiNonRadiative,
  kJpsiNonPromptRadiative,
  kJpsiNonPromptNonRadiative,
  kJpsiDecayElectron,
  kJpsiNonPromptDecayElectron,
  kJpsiPromptDecayElectron,
  kJpsiRadiativeDecayElectron,
  kJpsiNonRadiativeDecayElectron,
  kJpsiDecayPhoton
};
/*
enum MCFilters {
   kJpsiInclusive=0,
   kJpsiNonPrompt,
   kJpsiPrompt,
   kJpsiRadiative,
   kJpsiNonRadiative,
   kJpsiDecayElectron,
   kJpsiNonPromptDecayElectron,
   kJpsiPromptDecayElectron,
   kJpsiRadiativeDecayElectron,
   kJpsiNonRadiativeDecayElectron,
   kJpsiDecayPhoton
};
*/

enum TrackQualityFilterBits {       // as in AliReducedBaseTrack::fQualityFlags
   kTPCEventPlaneContributor = 0,
   kPhotonConversionV0Leg,
   kK0sV0Leg,
   kLambdaV0Leg,
   kAntiLambdaV0Leg,
   kKink0PositiveIndex,
   kKink1PositiveIndex,
   kKink2PositiveIndex,
   kPurePhotonConversionV0Leg,
   kPureK0sV0Leg,
   kPureLambdaV0Leg,
   kPureAntiLambdaV0Leg,
   kKink0NegativeIndex,
   kKink1NegativeIndex,
   kKink2NegativeIndex,
   kAODbits=15,
   kTRDmatch=26
};

enum AnalysisSystematicsFilterBit {
  kStandardAnalysis =0,
  kTrackingCutVar,
  kPIDSingleLeg,
  kPIDCutVar,
  kDCAVar
};

// run list string used for run IDs in the VarManager
/*const Int_t gkNRuns = 1325;
TString gRunList = "252375;252374;252371;252370;252368;252336;252332;252330;252326;252325;252322;252319;252317;252310;252271;252248;252235;253591;253589;253563;253530;253529;253517;253488;253482;253481;253478;253437;252867;252858;253978;253961;253958;253957;253956;253951;254332;254331;254330;254304;254303;254302;254293;254205;254204;254199;254193;254178;254175;254174;254149;254148;254147;254128;255469;255467;255466;255465;255463;255447;255442;255440;255421;255420;255419;255418;255415;255407;255402;255398;255352;255351;255350;255283;255280;255276;255275;255256;255255;255253;255252;255251;255249;255248;255247;255242;255240;255182;255181;255180;255177;255176;255174;255173;255171;255167;255162;255159;255154;255111;255091;255086;255085;255082;255079;254984;254983;254654;254653;254652;254651;254649;254648;254646;254644;254640;254632;254630;254629;254621;254608;254606;254604;255618;255617;255616;255615;255614;255592;255591;255583;255582;255577;255543;255542;255541;255540;255539;256420;256418;256417;256415;256373;256372;256371;256368;256366;256365;256364;256363;256362;256361;256357;256356;256311;256309;256307;256302;256299;256298;256297;256295;256292;256290;256289;256287;256284;256283;256282;256281;256231;256228;256227;256225;256223;256222;256219;256215;256213;256212;256210;256207;256204;258537;258499;258498;258477;258456;258454;258452;258426;258393;258391;258388;258387;258359;258336;258332;258307;258306;258303;258302;258301;258299;258280;258278;258274;258273;258271;258270;258258;258257;258256;258204;258203;258202;258198;258197;258178;258117;258114;258113;258109;258108;258107;258063;258062;258060;258059;258053;258049;258048;258045;258042;258041;258039;258019;258017;258014;258012;258008;258003;257992;257989;257986;257979;257963;257960;257958;257957;257939;257937;257936;257932;257912;257901;257893;257855;257853;257851;257850;257804;257803;257800;257799;257798;257797;257773;257765;257757;257754;257737;257735;257734;257733;257727;257725;257724;257697;257694;257692;257691;257689;257688;257687;257685;257684;257682;257644;257642;257636;257635;257632;257630;257606;257605;257604;257601;257595;257594;257592;257590;257588;257587;257566;257562;257561;257560;257541;257540;257539;257537;257531;257530;257492;257491;257490;257488;257487;257474;257468;257457;257433;257364;257358;257330;257322;257320;257318;257260;257224;257209;257206;257204;257145;257144;257142;257141;257140;257139;257138;257137;257136;257100;257095;257092;257086;257084;257083;257082;257080;257077;257071;257028;257026;257021;257012;257011;256944;256942;256941;259888;259868;259867;259866;259860;259842;259841;259822;259789;259788;259781;259756;259752;259751;259750;259748;259747;259477;259473;259396;259395;259394;259389;259388;259382;259381;259378;259342;259341;259340;259339;259336;259334;259307;259305;259303;259302;259274;259273;259272;259271;259270;259269;259264;259263;259261;259257;259204;259164;259162;259118;259117;259099;259096;259091;259090;259088;259086;258964;258962;264035;264033;263985;263984;263981;263979;263978;263977;263923;263920;263917;263916;263905;263866;263863;263861;263810;263803;263793;263792;263790;263787;263786;263785;263784;263744;263743;263741;263739;263738;263737;263691;263690;263689;263682;263663;263662;263657;263654;263653;263652;263647;263529;263497;263496;263490;263487;263332;263331;262858;262855;262853;262849;262847;262844;262842;262841;262778;262777;262776;262768;262760;262727;262725;262723;262719;262717;262713;262708;262706;262705;262635;262632;262628;262624;262594;262593;262583;262578;262574;262572;262571;262570;262569;262568;262567;262563;262537;262533;262532;262528;262492;262490;262489;262487;262451;262450;262430;262428;262426;262425;262424;264347;264346;264345;264341;264336;264312;264306;264305;264281;264279;264277;264273;264267;264266;264265;264264;264262;264261;264260;264259;264238;264235;264233;264232;264198;264197;264194;264190;264188;264168;264164;264139;264138;264137;264129;264110;264109;264086;264085;264082;264078;264076;270830;270828;270827;270824;270822;270865;270861;270856;270855;270854;273103;273101;273100;273099;273077;273010;273009;272985;272983;272976;272949;272947;272939;272935;272934;272933;272932;272905;272903;272880;272873;272871;272870;272836;272834;272833;272829;272828;272784;272783;272782;272764;272763;272762;272760;272749;272747;272746;272712;272692;272691;272690;272620;272610;272608;272607;272585;272577;272575;272574;272521;272469;272468;272466;272463;272462;272461;272417;272414;272413;272411;272400;272399;272395;272394;272389;272388;272360;272359;272340;272335;272194;272156;272155;272154;272153;272152;272151;272123;272101;272100;272076;272075;272042;272041;272040;272039;272038;272036;272020;272018;271886;271881;271880;271874;271873;271871;271870;271868;274442;274390;274389;274388;274387;274386;274385;274364;274363;274360;274357;274355;274352;274351;274329;274283;274281;274280;274278;274276;274271;274270;274269;274268;274266;274264;274263;274259;274258;274232;274212;274174;274148;274147;274125;274094;274092;274064;274063;274058;273986;273985;273946;273943;273942;273918;273889;273887;273886;273885;273825;273824;273719;273711;273709;273695;273690;273689;273687;273654;273653;273593;273592;273591;274671;274669;274667;274657;274653;274601;274596;274595;274594;274593;276508;276507;276506;276462;276439;276438;276437;276435;276351;276348;276312;276307;276302;276297;276294;276292;276291;276290;276259;276257;276230;276205;276178;276177;276170;276169;276166;276145;276141;276140;276135;276108;276105;276104;276102;276099;276098;276097;276045;276041;276040;276020;276019;276017;276013;276012;275925;275924;275847;275664;275661;275657;275650;275648;275647;275624;275623;275622;275621;275617;275612;275559;275558;275515;275472;275471;275467;275459;275457;275456;275453;275452;275448;275443;275406;275404;275401;275395;275394;275372;275369;275361;275360;275333;275332;275328;275326;275324;275322;275314;275283;275247;275246;275245;275239;275188;275184;275180;275177;275174;275173;275151;275150;275149;275076;275075;275073;275068;275067;274979;274978;274889;274886;274884;274883;274882;274878;274877;274822;274821;274817;274815;274811;274807;274806;274803;274802;274801;274736;274708;274690;278216;278215;278191;278189;278167;278166;278165;278164;278163;278158;278130;278127;278126;278123;278122;278121;277996;277991;277989;277988;277987;277952;277930;277907;277904;277903;277901;277900;277899;277898;277897;277876;277870;277848;277847;277845;277842;277841;277836;277834;277805;277802;277801;277800;277799;277795;277794;277749;277747;277746;277745;277725;277723;277722;277721;277577;277576;277575;277574;277537;277536;277534;277531;277530;277479;277478;277477;277476;277473;277472;277470;277418;277417;277416;277389;277386;277385;277384;277383;277360;277314;277312;277310;277293;277262;277257;277256;277197;277196;277194;277193;277189;277188;277184;277183;277182;277181;277180;277155;277121;277117;277091;277087;277082;277079;277076;277073;277037;277017;277016;277015;276972;276971;276970;276969;276967;276920;276917;276916;276762;276675;276674;276672;276671;276670;276669;276644;276608;276557;276556;276553;276552;276551;280140;280135;280134;280131;280126;280118;280114;280111;280108;280107;280066;280052;280051;279880;279879;279855;279854;279853;279830;279827;279826;279773;279749;279747;279719;279718;279715;279689;279688;279687;279684;279683;279682;279679;279677;279676;279642;279641;279632;279630;279559;279550;279491;279488;279487;279483;279441;279439;279435;279410;279391;279355;279354;279349;279348;279344;279342;279312;279310;279309;279274;279273;279270;279268;279267;279265;279264;279242;279238;279235;279234;279232;279208;279207;279201;279199;279157;279155;279130;279123;279122;279118;279117;279107;279106;279075;279074;279073;279069;279068;279044;279043;279041;279036;279035;279008;279007;279005;279000;278999;278964;278963;278960;278959;278941;278939;278936;278915;278914;281961;281956;281953;281940;281939;281932;281931;281928;281920;281918;281916;281915;281895;281894;281893;281892;281756;281755;281754;281753;281751;281750;281741;281713;281709;281707;281706;281705;281633;281592;281583;281581;281580;281574;281569;281568;281563;281562;281557;281511;281509;281477;281475;281450;281449;281446;281444;281443;281441;281415;281321;281301;281277;281275;281273;281271;281244;281243;281242;281241;281240;281213;281212;281191;281190;281189;281181;281180;281179;281081;281080;281062;281061;281060;281036;281035;281033;281032;280999;280998;280997;280996;280994;280990;280947;280943;280940;280936;280897;280890;280881;280880;280856;280854;280849;280848;280847;280845;280844;280842;280793;280792;280787;280786;280768;280767;280766;280765;280764;280763;280762;280761;280757;280756;280755;280754;280753;280729;280706;280705;280681;280679;280676;280673;280671;280650;280648;280647;280645;280639;280637;280636;280634;280613;280583;280581;280576;280575;280574;280551;280550;280547;280546;280519;280518;280499;280490;280448;280447;280446;280445;280443;280419;280415;280413;280412;280406;280405;280403;280375;280374;280352;280351;280350;280349;280348;280312;280310;280290;280286;280285;280284;280283;280282;282704;282703;282702;282700;282677;282676;282673;282671;282670;282668;282667;282666;282653;282651;282629;282622;282620;282618;282609;282608;282607;282606;282580;282579;282575;282573;282546;282545;282544;282528";
*/

//Including 2018 runs
const Int_t gkNRuns = 2017;
TString gRunList = "252375;252374;252371;252370;252368;252336;252332;252330;252326;252325;252322;252319;252317;252310;252271;252248;252235;253591;253589;253563;253530;253529;253517;253488;253482;253481;253478;253437;252867;252858;253978;253961;253958;253957;253956;253951;254332;254331;254330;254304;254303;254302;254293;254205;254204;254199;254193;254178;254175;254174;254149;254148;254147;254128;255469;255467;255466;255465;255463;255447;255442;255440;255421;255420;255419;255418;255415;255407;255402;255398;255352;255351;255350;255283;255280;255276;255275;255256;255255;255253;255252;255251;255249;255248;255247;255242;255240;255182;255181;255180;255177;255176;255174;255173;255171;255167;255162;255159;255154;255111;255091;255086;255085;255082;255079;254984;254983;254654;254653;254652;254651;254649;254648;254646;254644;254640;254632;254630;254629;254621;254608;254606;254604;255618;255617;255616;255615;255614;255592;255591;255583;255582;255577;255543;255542;255541;255540;255539;256420;256418;256417;256415;256373;256372;256371;256368;256366;256365;256364;256363;256362;256361;256357;256356;256311;256309;256307;256302;256299;256298;256297;256295;256292;256290;256289;256287;256284;256283;256282;256281;256231;256228;256227;256225;256223;256222;256219;256215;256213;256212;256210;256207;256204;258537;258499;258498;258477;258456;258454;258452;258426;258393;258391;258388;258387;258359;258336;258332;258307;258306;258303;258302;258301;258299;258280;258278;258274;258273;258271;258270;258258;258257;258256;258204;258203;258202;258198;258197;258178;258117;258114;258113;258109;258108;258107;258063;258062;258060;258059;258053;258049;258048;258045;258042;258041;258039;258019;258017;258014;258012;258008;258003;257992;257989;257986;257979;257963;257960;257958;257957;257939;257937;257936;257932;257912;257901;257893;257855;257853;257851;257850;257804;257803;257800;257799;257798;257797;257773;257765;257757;257754;257737;257735;257734;257733;257727;257725;257724;257697;257694;257692;257691;257689;257688;257687;257685;257684;257682;257644;257642;257636;257635;257632;257630;257606;257605;257604;257601;257595;257594;257592;257590;257588;257587;257566;257562;257561;257560;257541;257540;257539;257537;257531;257530;257492;257491;257490;257488;257487;257474;257468;257457;257433;257364;257358;257330;257322;257320;257318;257260;257224;257209;257206;257204;257145;257144;257142;257141;257140;257139;257138;257137;257136;257100;257095;257092;257086;257084;257083;257082;257080;257077;257071;257028;257026;257021;257012;257011;256944;256942;256941;259888;259868;259867;259866;259860;259842;259841;259822;259789;259788;259781;259756;259752;259751;259750;259748;259747;259477;259473;259396;259395;259394;259389;259388;259382;259381;259378;259342;259341;259340;259339;259336;259334;259307;259305;259303;259302;259274;259273;259272;259271;259270;259269;259264;259263;259261;259257;259204;259164;259162;259118;259117;259099;259096;259091;259090;259088;259086;258964;258962;264035;264033;263985;263984;263981;263979;263978;263977;263923;263920;263917;263916;263905;263866;263863;263861;263810;263803;263793;263792;263790;263787;263786;263785;263784;263744;263743;263741;263739;263738;263737;263691;263690;263689;263682;263663;263662;263657;263654;263653;263652;263647;263529;263497;263496;263490;263487;263332;263331;262858;262855;262853;262849;262847;262844;262842;262841;262778;262777;262776;262768;262760;262727;262725;262723;262719;262717;262713;262708;262706;262705;262635;262632;262628;262624;262594;262593;262583;262578;262574;262572;262571;262570;262569;262568;262567;262563;262537;262533;262532;262528;262492;262490;262489;262487;262451;262450;262430;262428;262426;262425;262424;264347;264346;264345;264341;264336;264312;264306;264305;264281;264279;264277;264273;264267;264266;264265;264264;264262;264261;264260;264259;264238;264235;264233;264232;264198;264197;264194;264190;264188;264168;264164;264139;264138;264137;264129;264110;264109;264086;264085;264082;264078;264076;270830;270828;270827;270824;270822;270865;270861;270856;270855;270854;273103;273101;273100;273099;273077;273010;273009;272985;272983;272976;272949;272947;272939;272935;272934;272933;272932;272905;272903;272880;272873;272871;272870;272836;272834;272833;272829;272828;272784;272783;272782;272764;272763;272762;272760;272749;272747;272746;272712;272692;272691;272690;272620;272610;272608;272607;272585;272577;272575;272574;272521;272469;272468;272466;272463;272462;272461;272417;272414;272413;272411;272400;272399;272395;272394;272389;272388;272360;272359;272340;272335;272194;272156;272155;272154;272153;272152;272151;272123;272101;272100;272076;272075;272042;272041;272040;272039;272038;272036;272020;272018;271886;271881;271880;271874;271873;271871;271870;271868;274442;274390;274389;274388;274387;274386;274385;274364;274363;274360;274357;274355;274352;274351;274329;274283;274281;274280;274278;274276;274271;274270;274269;274268;274266;274264;274263;274259;274258;274232;274212;274174;274148;274147;274125;274094;274092;274064;274063;274058;273986;273985;273946;273943;273942;273918;273889;273887;273886;273885;273825;273824;273719;273711;273709;273695;273690;273689;273687;273654;273653;273593;273592;273591;274671;274669;274667;274657;274653;274601;274596;274595;274594;274593;276508;276507;276506;276462;276439;276438;276437;276435;276351;276348;276312;276307;276302;276297;276294;276292;276291;276290;276259;276257;276230;276205;276178;276177;276170;276169;276166;276145;276141;276140;276135;276108;276105;276104;276102;276099;276098;276097;276045;276041;276040;276020;276019;276017;276013;276012;275925;275924;275847;275664;275661;275657;275650;275648;275647;275624;275623;275622;275621;275617;275612;275559;275558;275515;275472;275471;275467;275459;275457;275456;275453;275452;275448;275443;275406;275404;275401;275395;275394;275372;275369;275361;275360;275333;275332;275328;275326;275324;275322;275314;275283;275247;275246;275245;275239;275188;275184;275180;275177;275174;275173;275151;275150;275149;275076;275075;275073;275068;275067;274979;274978;274889;274886;274884;274883;274882;274878;274877;274822;274821;274817;274815;274811;274807;274806;274803;274802;274801;274736;274708;274690;278216;278215;278191;278189;278167;278166;278165;278164;278163;278158;278130;278127;278126;278123;278122;278121;277996;277991;277989;277988;277987;277952;277930;277907;277904;277903;277901;277900;277899;277898;277897;277876;277870;277848;277847;277845;277842;277841;277836;277834;277805;277802;277801;277800;277799;277795;277794;277749;277747;277746;277745;277725;277723;277722;277721;277577;277576;277575;277574;277537;277536;277534;277531;277530;277479;277478;277477;277476;277473;277472;277470;277418;277417;277416;277389;277386;277385;277384;277383;277360;277314;277312;277310;277293;277262;277257;277256;277197;277196;277194;277193;277189;277188;277184;277183;277182;277181;277180;277155;277121;277117;277091;277087;277082;277079;277076;277073;277037;277017;277016;277015;276972;276971;276970;276969;276967;276920;276917;276916;276762;276675;276674;276672;276671;276670;276669;276644;276608;276557;276556;276553;276552;276551;280140;280135;280134;280131;280126;280118;280114;280111;280108;280107;280066;280052;280051;279880;279879;279855;279854;279853;279830;279827;279826;279773;279749;279747;279719;279718;279715;279689;279688;279687;279684;279683;279682;279679;279677;279676;279642;279641;279632;279630;279559;279550;279491;279488;279487;279483;279441;279439;279435;279410;279391;279355;279354;279349;279348;279344;279342;279312;279310;279309;279274;279273;279270;279268;279267;279265;279264;279242;279238;279235;279234;279232;279208;279207;279201;279199;279157;279155;279130;279123;279122;279118;279117;279107;279106;279075;279074;279073;279069;279068;279044;279043;279041;279036;279035;279008;279007;279005;279000;278999;278964;278963;278960;278959;278941;278939;278936;278915;278914;281961;281956;281953;281940;281939;281932;281931;281928;281920;281918;281916;281915;281895;281894;281893;281892;281756;281755;281754;281753;281751;281750;281741;281713;281709;281707;281706;281705;281633;281592;281583;281581;281580;281574;281569;281568;281563;281562;281557;281511;281509;281477;281475;281450;281449;281446;281444;281443;281441;281415;281321;281301;281277;281275;281273;281271;281244;281243;281242;281241;281240;281213;281212;281191;281190;281189;281181;281180;281179;281081;281080;281062;281061;281060;281036;281035;281033;281032;280999;280998;280997;280996;280994;280990;280947;280943;280940;280936;280897;280890;280881;280880;280856;280854;280849;280848;280847;280845;280844;280842;280793;280792;280787;280786;280768;280767;280766;280765;280764;280763;280762;280761;280757;280756;280755;280754;280753;280729;280706;280705;280681;280679;280676;280673;280671;280650;280648;280647;280645;280639;280637;280636;280634;280613;280583;280581;280576;280575;280574;280551;280550;280547;280546;280519;280518;280499;280490;280448;280447;280446;280445;280443;280419;280415;280413;280412;280406;280405;280403;280375;280374;280352;280351;280350;280349;280348;280312;280310;280290;280286;280285;280284;280283;280282;282704;282703;282702;282700;282677;282676;282673;282671;282670;282668;282667;282666;282653;282651;282629;282622;282620;282618;282609;282608;282607;282606;282580;282579;282575;282573;282546;282545;282544;282528;286350;286349;286348;286345;286341;286340;286337;286336;286314;286313;286312;286311;286310;286309;286308;286289;286288;286287;286284;286282;286263;286261;286258;286257;286255;286254;286231;286230;286229;286203;286202;286201;286199;286198;286159;286130;286129;286127;286124;286064;286030;286028;286027;286025;286014;285980;285979;285978;286937;286936;286933;286932;286931;286930;286911;286910;286908;286907;286877;286876;286874;286852;286850;286848;286846;286810;286809;286805;286801;286799;286731;286695;286661;286653;286633;286594;286592;286591;286569;286568;286567;286566;286511;286509;286508;286502;286501;286482;286455;286454;286428;286427;286426;286380;287977;287975;287941;287923;287915;287913;287912;287911;287885;287884;287883;287877;287876;287784;287783;287658;287657;287656;287654;287578;287576;287575;287573;287524;287521;287520;287518;287517;287516;287513;287486;287484;287481;287480;287451;287413;287389;287388;287387;287385;287381;287380;287360;287356;287355;287353;287349;287347;287346;287344;287343;287325;287324;287323;287283;287254;287251;287250;287249;287248;287209;287208;287204;287203;287202;287201;287185;287155;287137;287077;287072;287071;287066;287064;287063;287021;287000;288619;288640;288642;288644;288650;288687;288689;288690;288743;288748;288750;288804;288806;288861;288862;288863;288864;288868;288897;288902;288903;288908;288909;288943;289165;289166;289167;289169;289172;289175;289176;289177;289198;289199;289200;289201;289971;289966;289965;289943;289941;289940;289935;289931;289928;289884;289880;289879;289857;289856;289855;289854;289852;289849;289830;289818;289817;289816;289815;289814;289811;289808;289775;289757;289732;289731;289729;289724;289723;289721;289666;289664;289660;289659;289658;289657;289634;289632;289625;289582;289577;289576;289574;289547;289521;289494;289493;289468;289466;289465;289463;289462;289444;289426;289374;289373;289370;289369;289368;289367;289366;289365;289356;289355;289354;289353;289309;289308;289306;289303;289300;289281;289280;289278;289277;289276;289275;289254;289253;289249;289247;289243;289242;289241;289240;292839;292836;292834;292832;292831;292811;292810;292809;292804;292803;292758;292754;292752;292750;292748;292747;292744;292739;292737;292704;292701;292698;292696;292695;292693;292586;292584;292563;292560;292559;292557;292554;292553;292526;292524;292523;292521;292500;292497;292496;292495;292461;292460;292457;292456;292434;292432;292430;292429;292428;292406;292405;292398;292397;292298;292274;292273;292270;292269;292265;292242;292241;292240;292218;292192;292168;292167;292166;292164;292163;292162;292161;292160;292140;292115;292114;292109;292108;292107;292106;292081;292080;292077;292075;292067;292062;292061;292060;292040;292012;291982;291977;291976;291953;291948;291946;291945;291944;291943;291942;291803;291796;291795;291769;291768;291766;291762;291760;291756;291755;291729;291706;291702;291698;291697;291694;291692;291690;291665;291661;291657;291626;291624;291622;291618;291615;291614;291590;291485;291484;291482;291481;291457;291456;291453;291451;291447;291446;291424;291420;291419;291417;291416;291402;291400;291399;291397;291377;291375;291373;291363;291362;291361;291360;291286;291285;291284;291283;291282;291266;291265;291263;291262;291257;291240;291209;291188;291143;291116;291111;291110;291101;291100;291093;291069;291066;291065;291041;291037;291035;291006;291005;291004;291003;291002;290980;290979;290976;290975;290974;290948;290944;290943;290941;290935;290932;290895;290894;290892;290888;290887;290886;290862;290860;290853;290848;290846;290843;290841;290790;290787;290776;290774;290769;290766;290764;290721;290699;290696;290692;290689;290687;290665;290660;290658;290645;290632;290627;290615;290614;290613;290612;290590;290588;290553;290550;290549;290544;290540;290539;290538;290501;290500;290499;290469;290467;290459;290458;290456;290428;290427;290426;290425;290423;290412;290411;290404;290401;290399;290376;290375;290374;290350;290327;290324;290323;293357;293359;293368;293386;293392;293413;293424;293474;293475;293494;293496;293497;293570;293571;293573;293578;293579;293582;293583;293587;293588;293686;293689;293690;293691;293692;293695;293696;293698;293740;293741;293770;293773;293774;293776;293799;293802;293805;293806;293807;293809;293829;293830;293831;293856;293886;293891;293893;293896;293898;294925;294916;294884;294883;294880;294877;294875;294852;294818;294817;294816;294815;294813;294809;294805;294775;294774;294772;294769;294749;294747;294746;294745;294744;294743;294742;294741;294722;294721;294718;294716;294715;294710;294703;294653;294636;294634;294633;294632;294593;294591;294590;294588;294587;294586;294563;294562;294558;294556;294553;294531;294530;294529;294527;294526;294525;294524;294310;294308;294307;294305;294242;294241;294212;294210;294208;294205;294201;294200;294199;294156;294155;294154;294152;294131;294013;294012;294011;294010;294009";

const Int_t gkNZBins = 21;
Double_t gZBinLims[gkNZBins] = {
  -10.,-9.,-8.,-7.,-6.,-5.,-4.,-3.,-2.,-1.,0.,1.,2.,3.,4.,5.,6.,7.,8.,9.,10.

};

const Int_t gkNZBinsMC = 2;
Double_t gZBinLimsMC[gkNZBinsMC] = {
   -10.0, 10.
};

const Int_t gkNRapBins = 4; //abs rap
Double_t gRapBinLims[gkNRapBins] = {
    0.,0.2,0.5,0.9
};
/*
const Int_t gkNRapBins = 5; //total rap
Double_t gRapBinLims[gkNRapBins] = {
    -0.9,-0.3,0.,0.3, 0.9
};
*/
/*const Int_t gkNSPDtrkBins = 8;
Double_t gSPDtrkBinLims[gkNSPDtrkBins] = {
   0., 5., 10., 15., 25., 35., 50., 110.
};*/
const Int_t gkNSPDtrkBins = 2;
Double_t gSPDtrkBinLims[gkNSPDtrkBins] = {
   0., 110.
};

// pt binning
const Int_t gkNPtBins = 29;
Double_t gPtLims[gkNPtBins] = {
   0.0,0.25, 0.5, 0.6,0.75, 1.0, 1.3,1.5, 2.0,
   2.5, 3.0,3.5, 4.0,4.5, 5.0, 5.5, 6.0,
   7.0,8.0,9.0, 10.,11., 12.,13., 14.,15.,16., 20.0, 50.
};

// pt binning for MC
const Int_t gkNPtBins2D = 501;
Double_t gPtLims2D[gkNPtBins2D] = {0.};

// pt binning for MC
const Int_t gkNPtBinsMC = 400;
Double_t gPtLimsMC[gkNPtBinsMC+1] = {0.};

// mass binning
const Int_t gkNMassBins = 79;
Double_t gMassBins[gkNMassBins] = {0.};

//Calibration needed
Bool_t gIsCalibrated = kFALSE;

//Forward declarations
void Setup(AliReducedAnalysisJpsi2ee* processor,Int_t triggerChoice, TString prod /*="LHC10h"*/, AnalysisSystematicsFilterBit systematicsCase);
void SetupCandidateElectronCuts(AliReducedAnalysisJpsi2ee* task, TString prod, AnalysisSystematicsFilterBit systematicsCase);
void SetupPIDSystematicsCuts(AliReducedAnalysisJpsi2ee* task, Bool_t reqSPDany=kTRUE, Bool_t isCalibrated = kFALSE, Bool_t addStandardCut=kTRUE, Bool_t useWithConversions=kFALSE);
void SetupPIDSystematicsCutsTest(AliReducedAnalysisJpsi2ee* task, Bool_t reqSPDany=kTRUE, Bool_t isCalibrated = kFALSE, Bool_t addStandardCut=kTRUE, Bool_t useWithConversions=kFALSE);
void AddStandardCut(AliReducedAnalysisJpsi2ee* task, Bool_t useSPDany=kTRUE, Bool_t isCalibrated = kFALSE);
void SetJPsiElectronNoPIDCut(AliReducedAnalysisJpsi2ee* task,Bool_t useSPDany=kTRUE);
void SetupDCASystematicsCuts(AliReducedAnalysisJpsi2ee* task, Bool_t addStandardCut=kTRUE, Bool_t isCalibrated = kFALSE);
void SetupTrackingSystematicCuts(AliReducedAnalysisJpsi2ee* task, Bool_t addStandardCut=kTRUE, Bool_t isCalibrated = kFALSE);
void SetupMCsignals(AliReducedAnalysisJpsi2ee* task);
void SetupMixingHandler(AliReducedAnalysisJpsi2ee* task);
void SetupHistogramManager(AliReducedAnalysisJpsi2ee* task, TString prod /*="LHC10h"*/);
void DefineHistograms(AliReducedAnalysisJpsi2ee* task, TString prod /*="LHC10h"*/);


//__________________________________________________________________________________________
AliAnalysisTask* AddTask_ilofnes_jpsi2ee_withCalibration(Bool_t isAliRoot=kTRUE, Int_t runMode=1, TString prod="LHC10h"){
   //
   // isAliRoot=kTRUE for ESD/AOD analysis in AliROOT, kFALSE for root analysis on reduced trees
   // runMode=1 (AliAnalysisTaskReducedEventProcessor::kUseOnTheFlyReducedEvents)
   //               =2 (AliAnalysisTaskReducedEventProcessor::kUseEventsFromTree)
   //
   //get the current analysis manager

  printf("INFO on AddTask_ilofnes_jpsi2ee(): (isAliRoot, runMode) :: (%d,%d) \n", isAliRoot, runMode);

  if(!isAliRoot) return 0x0;

  // settings according to production
  //-----------------------------------------------------------------------------------------------------------
  Bool_t isMC = kFALSE;
//  Bool_t isCalibrated = kFALSE;

  if (prod.Contains("LHC17h2")||prod.Contains("LHC18b1a")||prod.Contains("LHC19c6")) isMC = kTRUE;
  // 0 -> AliReducedVarManager::kINT7 | AliReducedVarManager::kHighMultV0
  // 1 -> AliReducedVarManager::kINT7
  // 2 -> AliReducedVarManager::kHighMultV0
  Int_t triggerChoice = 1; // NOTRE: could be done via production string as well, would be more flexible and less prone to error!



  AliReducedAnalysisJpsi2ee* jpsi2eeAnalysis = new AliReducedAnalysisJpsi2ee("Jpsi2eeAnalysis","Jpsi->ee analysis");
  jpsi2eeAnalysis->Init();
  jpsi2eeAnalysis->SetRunOverMC(isMC);
  AnalysisSystematicsFilterBit systematicsCase = kTrackingCutVar; //kStandardAnalysis, kTrackingCutVar, kPIDCutVar, kPIDSingleLeg
  Setup(jpsi2eeAnalysis,triggerChoice, prod,systematicsCase);
  // initialize an AliAnalysisTask which will wrapp the AliReducedAnalysisJpsi2ee such that it can be run in an aliroot analysis train (e.g. LEGO, local analysis etc)
  AliAnalysisTaskReducedEventProcessor* task = new AliAnalysisTaskReducedEventProcessor("ReducedEventAnalysisManager", runMode);
  task->AddTask(jpsi2eeAnalysis);

  // get analysis manager
  //-----------------------------------------------------------------------------------------------------------
  AliAnalysisManager *mgr = AliAnalysisManager::GetAnalysisManager();
  if (!mgr) {
     Error("AddTask_ilofnes_dst", "No analysis manager found.");
     return 0;
  }
  // get data container
  //-----------------------------------------------------------------------------------------------------------
  AliAnalysisDataContainer* cReducedEvent = NULL;
  if(runMode==AliAnalysisTaskReducedEventProcessor::kUseOnTheFlyReducedEvents) {
    printf("INFO on AddTask_ilofnes_jpsi2ee(): use on the fly events ");
    cReducedEvent = (AliAnalysisDataContainer*)mgr->GetContainers()->FindObject("ReducedEventDQ");
    if(!cReducedEvent) {
      printf("ERROR: In AddTask_ilofnes_jpsi2ee(), couldn't find exchange container with ReducedEvent! ");
      printf("             You need to use AddTask_ilofnes_dst() in the on-the-fly reduced events mode!");
      return 0x0;
    }
  }

  // add task to analysis manager
  //-----------------------------------------------------------------------------------------------------------
  mgr->AddTask(task);

  // connect input data containers
  //-----------------------------------------------------------------------------------------------------------
  if(runMode==AliAnalysisTaskReducedEventProcessor::kUseEventsFromTree)
     mgr->ConnectInput(task,  0, mgr->GetCommonInputContainer());

  if(runMode==AliAnalysisTaskReducedEventProcessor::kUseOnTheFlyReducedEvents)
     mgr->ConnectInput(task, 0, cReducedEvent);

  // connect output data containers
  //-----------------------------------------------------------------------------------------------------------
  //TString outputFilename = "AnalysisHistograms_jpsi2ee_systematics.root";
  //if(jpsi2eeAnalysis->GetRunOverMC()) outputFilename = "AnalysisHistograms_jpsi2ee_systematics_MC.root";
  TString outputFilename = "";
  switch (systematicsCase) {
    case kStandardAnalysis:
      if(jpsi2eeAnalysis->GetRunOverMC()) outputFilename = "AnalysisHistograms_jpsi2ee_standard_MC.root";
      else outputFilename = "AnalysisHistograms_jpsi2ee_standard.root";
    break;
    case kTrackingCutVar:
      if(jpsi2eeAnalysis->GetRunOverMC()) outputFilename = "AnalysisHistograms_jpsi2ee_TrackSystematics_MC.root";
      else outputFilename = "AnalysisHistograms_jpsi2ee_TrackSystematics.root";
    break;
    case kPIDSingleLeg:
      if(jpsi2eeAnalysis->GetRunOverMC()) outputFilename = "AnalysisHistograms_jpsi2ee_PIDSystematics_MC.root";
      else outputFilename = "AnalysisHistograms_jpsi2ee_PIDSystematics.root";
    break;
    case kPIDCutVar:
      if(jpsi2eeAnalysis->GetRunOverMC()) outputFilename = "AnalysisHistograms_jpsi2ee_PIDCutVar_MC.root";
      else outputFilename = "AnalysisHistograms_jpsi2ee_PIDCutVar.root";
    break;
    case kDCAVar:
      if(jpsi2eeAnalysis->GetRunOverMC()) outputFilename = "AnalysisHistograms_jpsi2ee_DCACutVar_MC.root";
      else outputFilename = "AnalysisHistograms_jpsi2ee_DCACutVar.root";
    break;
  }






  AliAnalysisDataContainer *cOutputHist = mgr->CreateContainer("jpsi2eeHistos", THashList::Class(),
                                                               AliAnalysisManager::kOutputContainer, outputFilename.Data());
  mgr->ConnectOutput(task, 1, cOutputHist );

  return task;
}


//_________________________________________________________________
void Setup(AliReducedAnalysisJpsi2ee* processor,Int_t triggerChoice, TString prod /*="LHC10h"*/, AnalysisSystematicsFilterBit systematicsCase) {
  //
  // Configure the analysis task
  // Setup histograms, handlers, cuts, etc.
  //
  Bool_t isMC = processor->GetRunOverMC();
  //For MC and PIDsingle leg, do not run event mixing and like-sing pairing to save CPU time
  if ((isMC) || (systematicsCase == kPIDSingleLeg)) {
    //processor->SetLoopOverTracks(kFALSE);
    processor->SetRunEventMixing(kFALSE);
    //processor->SetRunPairing(kFALSE);
    processor->SetRunLikeSignPairing(kFALSE);
    if (systematicsCase == kPIDSingleLeg) processor->SetRunPairing(kFALSE);
  }
  else {
  //processor->SetLoopOverTracks(kFALSE);
  //processor->SetRunEventMixing(kFALSE);
  //processor->SetRunPairing(kFALSE);
  //processor->SetRunOverMC(isMC);
  //processor->SetRunLikeSignPairing(kFALSE);
  }
  /*
  if (!isMC)  {
    //processor->SetLoopOverTracks(kFALSE);
    //processor->SetRunEventMixing(kFALSE);
    //processor->SetRunPairing(kFALSE);
    //processor->SetRunLikeSignPairing(kFALSE);
  }
  else {
  //processor->SetLoopOverTracks(kFALSE);
  processor->SetRunEventMixing(kFALSE);
  //processor->SetRunPairing(kFALSE);
  //processor->SetRunOverMC(isMC);
  processor->SetRunLikeSignPairing(kFALSE);
} */
  //Set pt whieghts
TFile* fW = TFile::Open("/home/alidock/AliceWork/Analysis/ptWeights/ratio_13TeV_two.root");
  TH1F* weights =  (TH1F*)fW->Get("weightsNew");
  processor->SetMCJpsiPtWeights(weights);
    
    
  //TPC calibration for periods missing TPC-splines
  if( !processor->GetRunOverMC() && prod.Contains("LHC16f")) {
      //Note: for LHC18j a copy of LHC18h is put into calibration folder for LHC18j due to low statistics
      TFile* fileElectron = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2016/%s/CalibrationOutput/electron/TPCpidCalibelectron.root", prod.Data()));
      THnF* eleCentroid = (THnF*)fileElectron->Get("Centroid_electron");
      THnF* eleWidth = (THnF*)fileElectron->Get("Width_electron");
      THnI* eleStatus = (THnI*)fileElectron->Get("Status_electron");
      AliReducedVarManager::SetTPCpidCalibMaps(0, eleCentroid, eleWidth, eleStatus);
      
      TFile* filePion     = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2016/%s/CalibrationOutput/pion/TPCpidCalibpion.root", prod.Data()));
      THnF* pioCentroid = (THnF*)filePion->Get("Centroid_pion");
      THnF* pioWidth = (THnF*)filePion->Get("Width_pion");
      THnI* pioStatus = (THnI*)filePion->Get("Status_pion");
      AliReducedVarManager::SetTPCpidCalibMaps(1, pioCentroid, pioWidth, pioStatus);
      
      TFile* fileProton   = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2016/%s/CalibrationOutput/proton/TPCpidCalibproton.root", prod.Data()));
      THnF* proCentroid = (THnF*)fileProton->Get("Centroid_proton");
      THnF* proWidth = (THnF*)fileProton->Get("Width_proton");
      THnI* proStatus = (THnI*)fileProton->Get("Status_proton");
      AliReducedVarManager::SetTPCpidCalibMaps(2, proCentroid, proWidth, proStatus);
      
      AliReducedVarManager::Variables depVars[4] = {
         AliReducedVarManager::kEta, AliReducedVarManager::kSDDandSSDclusters, AliReducedVarManager::kTPCpileupZAC,          AliReducedVarManager::kTPCpileupContributorsAC
      };
      AliReducedVarManager::SetTPCpidCalibDepVars(depVars);
      fileElectron->Close();
      filePion->Close();
      fileProton->Close();
    gIsCalibrated = kTRUE;
  }
  else if(!processor->GetRunOverMC() && prod.Contains("LHC17e") ) {
      TFile* fileElectron = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2017/%s/CalibrationOutput/electron/TPCpidCalibelectron.root", prod.Data()));
      THnF* eleCentroid = (THnF*)fileElectron->Get("Centroid_electron");
      THnF* eleWidth = (THnF*)fileElectron->Get("Width_electron");
      THnI* eleStatus = (THnI*)fileElectron->Get("Status_electron");
      AliReducedVarManager::SetTPCpidCalibMaps(0, eleCentroid, eleWidth, eleStatus);
      
      TFile* filePion     = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2017/%s/CalibrationOutput/pion/TPCpidCalibpion.root", prod.Data()));
      THnF* pioCentroid = (THnF*)filePion->Get("Centroid_pion");
      THnF* pioWidth = (THnF*)filePion->Get("Width_pion");
      THnI* pioStatus = (THnI*)filePion->Get("Status_pion");
      AliReducedVarManager::SetTPCpidCalibMaps(1, pioCentroid, pioWidth, pioStatus);
      
      TFile* fileProton   = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2017/%s/CalibrationOutput/proton/TPCpidCalibproton.root", prod.Data()));
      THnF* proCentroid = (THnF*)fileProton->Get("Centroid_proton");
      THnF* proWidth = (THnF*)fileProton->Get("Width_proton");
      THnI* proStatus = (THnI*)fileProton->Get("Status_proton");
      AliReducedVarManager::SetTPCpidCalibMaps(2, proCentroid, proWidth, proStatus);
      
      AliReducedVarManager::Variables depVars[4] = {
         AliReducedVarManager::kEta, AliReducedVarManager::kSDDandSSDclusters, AliReducedVarManager::kTPCpileupZAC,          AliReducedVarManager::kTPCpileupContributorsAC
      };
      AliReducedVarManager::SetTPCpidCalibDepVars(depVars);
      fileElectron->Close();
      filePion->Close();
      fileProton->Close();
    gIsCalibrated = kTRUE;
  }

  else if(!processor->GetRunOverMC() && (prod.Contains("LHC18f") || prod.Contains("LHC18g") || prod.Contains("LHC18h") || prod.Contains("LHC18j") || prod.Contains("LHC18k") || prod.Contains("LHC18l") || prod.Contains("LHC18n") || prod.Contains("LHC18o") || prod.Contains("LHC18p"))) {
      //Note: for LHC18j a copy of LHC18h is put into calibration folder for LHC18j due to low statistics
      TFile* fileElectron = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2018/%s/CalibrationOutput/electron/TPCpidCalibelectron.root", prod.Data()));
      THnF* eleCentroid = (THnF*)fileElectron->Get("Centroid_electron");
      THnF* eleWidth = (THnF*)fileElectron->Get("Width_electron");
      THnI* eleStatus = (THnI*)fileElectron->Get("Status_electron");
      AliReducedVarManager::SetTPCpidCalibMaps(0, eleCentroid, eleWidth, eleStatus);
      
      TFile* filePion     = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2018/%s/CalibrationOutput/pion/TPCpidCalibpion.root", prod.Data()));
      THnF* pioCentroid = (THnF*)filePion->Get("Centroid_pion");
      THnF* pioWidth = (THnF*)filePion->Get("Width_pion");
      THnI* pioStatus = (THnI*)filePion->Get("Status_pion");
      AliReducedVarManager::SetTPCpidCalibMaps(1, pioCentroid, pioWidth, pioStatus);
      
      TFile* fileProton   = TFile::Open(Form("/home/alidock/AliceWork/Analysis/CalibrationNew/data_2018/%s/CalibrationOutput/proton/TPCpidCalibproton.root", prod.Data()));
      THnF* proCentroid = (THnF*)fileProton->Get("Centroid_proton");
      THnF* proWidth = (THnF*)fileProton->Get("Width_proton");
      THnI* proStatus = (THnI*)fileProton->Get("Status_proton");
      AliReducedVarManager::SetTPCpidCalibMaps(2, proCentroid, proWidth, proStatus);
      
      AliReducedVarManager::Variables depVars[4] = {
         AliReducedVarManager::kEta, AliReducedVarManager::kSDDandSSDclusters, AliReducedVarManager::kTPCpileupZAC,          AliReducedVarManager::kTPCpileupContributorsAC
      };
      AliReducedVarManager::SetTPCpidCalibDepVars(depVars);
      
    gIsCalibrated = kTRUE;
      fileElectron->Close();
      filePion->Close();
      fileProton->Close();
  }


  // Set event cuts
  AliReducedEventCut* evCut1 = new AliReducedEventCut("Centrality","Centrality selection");
  evCut1->AddCut(AliReducedVarManager::kVtxZ, -10.0, 10.0);
  if(!processor->GetRunOverMC()) evCut1->AddCut(AliReducedVarManager::kIsPhysicsSelection, 0.1, 2.);   // request physics selection
  //evCut1->EnableVertexDistanceCut();
  if (triggerChoice==0)       evCut1->AddEventTriggerFilter(AliReducedVarManager::kINT7 | AliReducedVarManager::kHighMultV0); // MB + high mult.
  else if (triggerChoice==1)  evCut1->AddEventTriggerFilter(AliReducedVarManager::kINT7);                                     // MB
  else if (triggerChoice==2)  evCut1->AddEventTriggerFilter(AliReducedVarManager::kHighMultV0);                               // high mult.
  else                        evCut1->AddEventTriggerFilter(AliReducedVarManager::kINT7 | AliReducedVarManager::kHighMultV0); // MB + high mult.
  evCut1->AddEventTriggerFilter(AliReducedVarManager::kINT7);
  evCut1->AddEventTagFilterBit(9, kTRUE); //IsPileupFromSPD(3,0.8,3.,2.,5.)
  evCut1->AddEventTagFilterBit(1,kTRUE); // multi-vertexer pileup, NOTE: throws away TONS (at least in LHC16d)

  processor->AddEventCut(evCut1);

  SetupCandidateElectronCuts(processor, prod,systematicsCase);

  // set run numbers for runwise histograms
  //gRunList = SetRunNumbersReducedTPC(prod);
  if(processor->GetRunOverMC()) SetupMCsignals(processor);
  // define histograms histograms
  SetupHistogramManager(processor, prod);
  // mixing handler
  SetupMixingHandler(processor);
}



//_________________________________________________________________
void SetupCandidateElectronCuts(AliReducedAnalysisJpsi2ee* task, TString prod, AnalysisSystematicsFilterBit systematicsCase) {
   //
   //  setup a standard electron candidate cut
   //

   //SetupTrackingSystematicsCutsSingleLeg(task, kFALSE);

   //SetupTrackingSystematicsCuts(task, kTRUE, kFALSE);
   //SetupPIDSystematicsCuts(task, kTRUE, kFALSE, kTRUE);
   //SetupDCASystematicsCuts(task, kTRUE, kFALSE);

   //AddStandardCut(task, kTRUE, kFALSE);

   switch (systematicsCase) {
     case kStandardAnalysis:
        if(gIsCalibrated)
           AddStandardCut(task, kTRUE, kTRUE);                                // standard cut with SPDany and  PID calibration
        else
           AddStandardCut(task, kTRUE, kFALSE);                                 // standard cut with SPDany and with no PID calibration
        if (task->GetRunOverMC())
          SetJPsiElectronNoPIDCut(task,kTRUE);                                  //NoPID cut with SPDany
     break;
     case kTrackingCutVar:
        if(gIsCalibrated)
           SetupTrackingSystematicCuts(task, kTRUE, kTRUE);                     // tracking systematics + standard cut + with PID calibration
        else
           SetupTrackingSystematicCuts(task, kTRUE, kFALSE);                    // tracking systematics + standard cut + no PID calibration
     break;
     case kPIDSingleLeg:
        if(gIsCalibrated)
           SetupPIDSystematicsCuts(task, kFALSE, kTRUE, kFALSE, kTRUE);        // PID systematics + no SPDany + with PID calibration +  standard cut + with conversion electrons
        else
           SetupPIDSystematicsCuts(task, kFALSE, kFALSE, kFALSE, kTRUE);        // PID systematics + no SPDany + no PID calibration +  standard cut + with conversion electrons
     break;
     case kPIDCutVar:
        if(gIsCalibrated)
            SetupPIDSystematicsCuts(task, kTRUE, kTRUE, kTRUE, kFALSE);                 // PID systematics + SPDany + with PID calibration + standard cut + with primary electrons
        else
            SetupPIDSystematicsCuts(task, kTRUE, kFALSE, kTRUE, kFALSE);                // PID systematics + SPDany + no PID calibration + standard cut + with primary electrons

     break;
     case kDCAVar:
        if(gIsCalibrated)
            SetupDCASystematicsCuts(task, kTRUE, kTRUE);                 // DCA systematics  + standard cut+ with PID calibration
        else
            SetupDCASystematicsCuts(task, kTRUE, kFALSE);                // DCA systematics + standard cut + no PID calibration

     break;
   }


   //*******************************************************************************
   // To run for systematics (one configuration at a time)

   // Standard cut alone
/*   if(gIsCalibrated)
      AddStandardCut(task, kTRUE, kTRUE);                                // standard cut with SPDany and  PID calibration
   else
      AddStandardCut(task, kTRUE, kFALSE);                                 // standard cut with SPDany and with no PID calibration
*/

   //   Tracking systematics -----------------------------------------------------------------------
/*   if(gIsCalibrated)
      SetupTrackingSystematicCuts(task, kTRUE, kTRUE);                     // tracking systematics + standard cut + with PID calibration
   else
      SetupTrackingSystematicCuts(task, kTRUE, kFALSE);                    // tracking systematics + standard cut + no PID calibration
*/
   //    Single electron PID systematics -----------------------------------------------------------
/*   if(gIsCalibrated)
      SetupPIDSystematicsCuts(task, kTRUE, kTRUE, kTRUE, kTRUE);        // PID systematics + SPDany + with PID calibration + no standard cut + with conversion electrons
   else
      SetupPIDSystematicsCuts(task, kTRUE, kFALSE, kTRUE, kTRUE);        // PID systematics + SPDany + no PID calibration + no standard cut + with conversion electrons
*/
   //   Dielectron pair PID systematics ------------------------------------------------------------
  /* if(gIsCalibrated) SetupPIDSystematicsCuts(task, kTRUE, kTRUE, kTRUE, kFALSE);                 // PID systematics + SPDany + with PID calibration + standard cut + with primary electrons
   else                SetupPIDSystematicsCuts(task, kTRUE, kFALSE, kTRUE, kFALSE);                // PID systematics + SPDany + no PID calibration + standard cut + with primary electrons
*/
   //*******************************************************************************
    cout << "SET prefilter: " << endl;
   if ((!task->GetRunOverMC()) && (!(systematicsCase == kPIDSingleLeg))) {
       cout << "yes" << endl;
     // set track prefilter cuts
     AliReducedTrackCut* prefTrackCut = new AliReducedTrackCut("prefCut","prefilter selection");
     prefTrackCut->SetTrackFilterBit(kPrefilterCut);
     prefTrackCut->AddCut(AliReducedVarManager::kPt, 0.3,100.0);
     prefTrackCut->SetRequestITSrefit();
     task->AddPrefilterTrackCut(prefTrackCut);

     // set pair prefilter cuts
     AliReducedVarCut* prefPairCut = new AliReducedVarCut("prefCutM50MeV","prefilter pair cuts");
     prefPairCut->AddCut(AliReducedVarManager::kMass, 0.0, 0.05, kTRUE);
     task->AddPrefilterPairCut(prefPairCut);
   }
   else cout << "no" <<endl;
     // Set pair cuts
     AliReducedTrackCut* pairCut1 = new AliReducedTrackCut("Ptpair","Pt pair selection");
     pairCut1->AddCut(AliReducedVarManager::kPt, 0.0,100.0);
     pairCut1->AddCut(AliReducedVarManager::kRap, -0.9,0.9);
     task->AddPairCut(pairCut1);

}

//__________________________________________________________________________________________
void SetupPIDSystematicsCuts(AliReducedAnalysisJpsi2ee* task, Bool_t reqSPDany /*=kTRUE*/, Bool_t isCalibrated /*= kFALSE*/, Bool_t addStandardCut /*=kTRUE*/, Bool_t useWithConversions/*=kFALSE*/) {
   //
   // Apply tracking cuts variations on the electron candidates
   //
   Bool_t isMC = task->GetRunOverMC();

   // common cuts
   AliReducedTrackCut* commonCuts = new AliReducedTrackCut("commonCuts","");
   if(!useWithConversions) {
     if (isMC){
       commonCuts->SetTrackFilterBit(kBasicCut);  // eta cut, ITS and TPC refit , TPCncls already applied
     }
     else {
       commonCuts->SetUseANDonTrackFilterMap(kFALSE);
       commonCuts->SetTrackFilterBit(kBasicCut);    // eta cut, DCA cuts, ITS and TPC refit already applied
       commonCuts->SetTrackFilterBit(kPIDopen);
     }
   }
   else {
      if(!isMC) commonCuts->SetTrackQualityFilterBit(kPhotonConversionV0Leg, kFALSE);
      commonCuts->SetRequestITSrefit();
   }



   commonCuts->AddCut(AliReducedVarManager::kPt, 0.0, 1.0, kTRUE);
   commonCuts->AddCut(AliReducedVarManager::kITSchi2, 0.0, 36.);
   commonCuts->AddCut(AliReducedVarManager::kTPCchi2, 0., 4.);
   if(!useWithConversions) {
      if(reqSPDany) commonCuts->SetRequestSPDany();
      else          commonCuts->SetRequestSPDfirst();
   }
   commonCuts->SetRejectKinks();
   if(!useWithConversions) {
      commonCuts->SetRequestITSrefit();
      commonCuts->SetRequestTPCrefit();
      commonCuts->AddCut(AliReducedVarManager::kEta, -0.9,0.9);
      commonCuts->AddCut(AliReducedVarManager::kTPCncls, 70.,160.0);
      commonCuts->AddCut(AliReducedVarManager::kITSnclsShared, 1.9, 6., kTRUE);
      commonCuts->AddCut(AliReducedVarManager::kTPCNclusBitsFired, 6., 9.);
       commonCuts->AddCut(AliReducedVarManager::kDcaXY, -0.2, 0.2); //-0.5, 0.5
       commonCuts->AddCut(AliReducedVarManager::kDcaZ, -0.4, 0.4); // -2.0, 2.0
   }

   if(addStandardCut) {
      AddStandardCut(task, reqSPDany, isCalibrated);
   }

   if(useWithConversions) {
      AliReducedCompositeCut* basicElectronSelection = new AliReducedCompositeCut("basicElectronCut", "");
      basicElectronSelection->AddCut(commonCuts);
      task->AddTrackCut(basicElectronSelection);

      AliReducedCompositeCut* electronFullBand = new AliReducedCompositeCut("electronFullBand", "", kTRUE);
      electronFullBand->AddCut(basicElectronSelection);
      AliReducedTrackCut* electronFullBandVarCut = new AliReducedTrackCut();
       if(isMC || !isCalibrated) {
           electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -3.0, 3.0);
           electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
           electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);
       }
       else    {   electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -3.0, 3.0);
      //electronFullBandVarCut->AddCut(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton, 2.0, 30000.0);
           electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
           electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);
       }
      electronFullBand->AddCut(electronFullBandVarCut);
      task->AddTrackCut(electronFullBand);

      AliReducedCompositeCut* electronLowerHalf = new AliReducedCompositeCut("electronLowerHalf", "", kTRUE);
      electronLowerHalf->AddCut(basicElectronSelection);
      AliReducedTrackCut* electronLowerHalfVarCut = new AliReducedTrackCut();
       if(isMC || !isCalibrated) {
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -3.0, 0.0);
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);
       }
       else   {
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -3.0, 0.0);
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);
       }
      electronLowerHalf->AddCut(electronLowerHalfVarCut);
      task->AddTrackCut(electronLowerHalf);

      AliReducedCompositeCut* electronUpperHalf = new AliReducedCompositeCut("electronUpperHalf", "", kTRUE);
      electronUpperHalf->AddCut(basicElectronSelection);
      AliReducedTrackCut* electronUpperHalfVarCut = new AliReducedTrackCut();
       if(isMC || !isCalibrated) {
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), 0.0, 3.0);
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);
       }
       else      {
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), 0.0, 3.0);
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 2., 30000.0, kFALSE,
                               AliReducedVarManager::kPin, 0.0, 10000.0);
       }
      electronUpperHalf->AddCut(electronUpperHalfVarCut);
      task->AddTrackCut(electronUpperHalf);
   }

   const Int_t kNsystEleVariations = 5;
   Float_t systEleVariations[kNsystEleVariations][2] = {
      {-2.0, 3.0}, {-1.5,3.0}, {-2.5,3.0}, {-2.0, 2.0}, {-2.0, 3.5}
   };
   const Int_t kNsystProtVariations = 3;
   Float_t systProtVariations[kNsystProtVariations] = {3.0, 2.5, 3.5};
   const Int_t kNsystPionVariations = 3;
    Float_t systPionVariations[kNsystPionVariations] = {3.0,2.5, 3.5};  //2.5, 3.5

   for(Int_t iele=0; iele<kNsystEleVariations; ++iele) {
      for(Int_t ipro=0; ipro<kNsystProtVariations; ++ipro) {
         for(Int_t ipio=0; ipio<kNsystPionVariations; ++ipio) {

            if(addStandardCut && iele==0 && ipro==0 && ipio==0) continue;

            TString cutName="Standard";
            if(iele!=0 || ipro!=0 || ipio!=0)
               cutName = Form("electron%d_prot%d_pion%d", iele, ipro, ipio);

            // for the single leg study with conversions we vary just one of the cuts, while keeping the others at their default
            Int_t nZeroes = 0;
            if(iele==0) nZeroes++;
            if(ipro==0) nZeroes++;
            if(ipio==0) nZeroes++;
            if(useWithConversions && nZeroes<2) continue;

            AliReducedCompositeCut* cut = new AliReducedCompositeCut(cutName.Data(), "", kTRUE);
            cut->AddCut(commonCuts);
            AliReducedTrackCut* varCut = new AliReducedTrackCut(Form("%s_varCut", cutName.Data()), "");
             if(task->GetRunOverMC() || !isCalibrated) {
               varCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), systEleVariations[iele][0], systEleVariations[iele][1]);
                 varCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), systProtVariations[ipro], 30000.0, kFALSE,
                                 AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
                  varCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), systPionVariations[ipio], 30000.0, kFALSE,
                                 AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
             }
             else {
               varCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), systEleVariations[iele][0], systEleVariations[iele][1]);
                 varCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), systProtVariations[ipro], 30000.0, kFALSE,
                                AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
                 varCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), systPionVariations[ipio], 30000.0, kFALSE,
                                AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
             }
            cut->AddCut(varCut);

            task->AddTrackCut(cut);
         }  // end loop over pion rej settings
      }  // end loop over proton rej settings
   }  // end loop over electron inclusion setting
}


//__________________________________________________________________________________________
void SetupPIDSystematicsCutsTest(AliReducedAnalysisJpsi2ee* task, Bool_t reqSPDany /*=kTRUE*/, Bool_t isCalibrated /*= kFALSE*/, Bool_t addStandardCut /*=kTRUE*/, Bool_t useWithConversions/*=kFALSE*/) {
   //
   // Apply tracking cuts variations on the electron candidates
   //
   Bool_t isMC = task->GetRunOverMC();

   // common cuts
   AliReducedTrackCut* commonCuts = new AliReducedTrackCut("commonCuts","");
   if(!useWithConversions) {
     if (isMC){
       commonCuts->SetTrackFilterBit(kBasicCut);  // eta cut, ITS and TPC refit , TPCncls already applied
     }
     else {
       commonCuts->SetUseANDonTrackFilterMap(kFALSE);
       commonCuts->SetTrackFilterBit(kBasicCut);    // eta cut, DCA cuts, ITS and TPC refit already applied
       commonCuts->SetTrackFilterBit(kPIDopen);
     }
   }
   else {
      if(!isMC) commonCuts->SetTrackQualityFilterBit(kPhotonConversionV0Leg, kFALSE);
      commonCuts->SetRequestITSrefit();
   }



   commonCuts->AddCut(AliReducedVarManager::kPt, 0.0, 1.0, kTRUE);
   commonCuts->AddCut(AliReducedVarManager::kITSchi2, 0.0, 36.);
   commonCuts->AddCut(AliReducedVarManager::kTPCchi2, 0., 4.);
   if(!useWithConversions) {
      if(reqSPDany) commonCuts->SetRequestSPDany();
      else          commonCuts->SetRequestSPDfirst();
   }
   commonCuts->SetRejectKinks();
   if(!useWithConversions) {
      commonCuts->SetRequestITSrefit();
      commonCuts->SetRequestTPCrefit();
      commonCuts->AddCut(AliReducedVarManager::kEta, -0.9,0.9);
      commonCuts->AddCut(AliReducedVarManager::kTPCncls, 70.,160.0);
      commonCuts->AddCut(AliReducedVarManager::kITSnclsShared, 1.9, 6., kTRUE);
      commonCuts->AddCut(AliReducedVarManager::kTPCNclusBitsFired, 6., 9.);
       commonCuts->AddCut(AliReducedVarManager::kDcaXY, -0.2, 0.2); //-0.5, 0.5
       commonCuts->AddCut(AliReducedVarManager::kDcaZ, -0.4, 0.4); // -2.0, 2.0
   }

   if(addStandardCut) {
      AddStandardCut(task, reqSPDany, isCalibrated);
   }

   if(useWithConversions) {
      AliReducedCompositeCut* basicElectronSelection = new AliReducedCompositeCut("basicElectronCut", "");
      basicElectronSelection->AddCut(commonCuts);
      task->AddTrackCut(basicElectronSelection);

      AliReducedCompositeCut* electronFullBand = new AliReducedCompositeCut("electronFullBand", "", kTRUE);
      electronFullBand->AddCut(basicElectronSelection);
      AliReducedTrackCut* electronFullBandVarCut = new AliReducedTrackCut();
       if(isMC || !isCalibrated) {
           electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -3.0, 3.0);
       }
       else    {   electronFullBandVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -3.0, 3.0);
       }
      electronFullBand->AddCut(electronFullBandVarCut);
      task->AddTrackCut(electronFullBand);

      AliReducedCompositeCut* electronLowerHalf = new AliReducedCompositeCut("electronLowerHalf", "", kTRUE);
      electronLowerHalf->AddCut(basicElectronSelection);
      AliReducedTrackCut* electronLowerHalfVarCut = new AliReducedTrackCut();
       if(isMC || !isCalibrated) {
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -3.0, 0.0);
       }
       else   {
           electronLowerHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -3.0, 0.0);
       }
      electronLowerHalf->AddCut(electronLowerHalfVarCut);
      task->AddTrackCut(electronLowerHalf);

      AliReducedCompositeCut* electronUpperHalf = new AliReducedCompositeCut("electronUpperHalf", "", kTRUE);
      electronUpperHalf->AddCut(basicElectronSelection);
      AliReducedTrackCut* electronUpperHalfVarCut = new AliReducedTrackCut();
       if(isMC || !isCalibrated) {
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), 0.0, 3.0);
       }
       else      {
           electronUpperHalfVarCut->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), 0.0, 3.0);
       }
      electronUpperHalf->AddCut(electronUpperHalfVarCut);
      task->AddTrackCut(electronUpperHalf);
       
       
   }

   //Test cuts - electron 3 sigma cut
    AliReducedCompositeCut* cutElectron = new AliReducedCompositeCut("electronCut", "", kTRUE);
    cutElectron->AddCut(commonCuts);
    AliReducedTrackCut* varCutElectron = new AliReducedTrackCut("electronCut_varCut", "");
     if(task->GetRunOverMC() || !isCalibrated) {
       varCutElectron->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -3.0, 3.0);
     }
     else {
       varCutElectron->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -3.0, 3.0);
     }
    cutElectron->AddCut(varCutElectron);
    task->AddTrackCut(cutElectron);
    
    //Test cuts - electron 1 sigma cut
     AliReducedCompositeCut* cutElectronTight = new AliReducedCompositeCut("electronTightCut", "", kTRUE);
     cutElectronTight->AddCut(commonCuts);
     AliReducedTrackCut* varCutElectronTight = new AliReducedTrackCut("electronTightCut_varCut", "");
      if(task->GetRunOverMC() || !isCalibrated) {
        varCutElectronTight->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -1.0, 1.0);
      }
      else {
        varCutElectronTight->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -1.0, 1.0);
      }
     cutElectronTight->AddCut(varCutElectronTight);
     task->AddTrackCut(cutElectronTight);
    
    //Test cuts - electron 3 sigma cut low
     AliReducedCompositeCut* cutElectronLow = new AliReducedCompositeCut("electronLowCut", "", kTRUE);
     cutElectronLow->AddCut(commonCuts);
     AliReducedTrackCut* varCutElectronLow = new AliReducedTrackCut("electronLowCut_varCut", "");
      if(task->GetRunOverMC() || !isCalibrated) {
        varCutElectronLow->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -3.0, 0.0);
      }
      else {
        varCutElectronLow->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -3.0, 0.0);
      }
     cutElectronLow->AddCut(varCutElectronLow);
     task->AddTrackCut(cutElectronLow);
    
    //Test cuts - proton cut
     AliReducedCompositeCut* cutProton = new AliReducedCompositeCut("protonCut", "", kTRUE);
     cutProton->AddCut(commonCuts);
     AliReducedTrackCut* varCutProton = new AliReducedTrackCut("protonCut_varCut", "");
      if(task->GetRunOverMC() || !isCalibrated) {
          varCutProton->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                     AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
      }
      else {
        varCutProton->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                       AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
      }
     cutProton->AddCut(varCutProton);
     task->AddTrackCut(cutProton);
    
    
    //Test cuts - pion cut
     AliReducedCompositeCut* cutPion = new AliReducedCompositeCut("pionCut", "", kTRUE);
     cutPion->AddCut(commonCuts);
     AliReducedTrackCut* varCutPion = new AliReducedTrackCut("pionCut_varCut", "");
      if(task->GetRunOverMC() || !isCalibrated) {
          varCutPion->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                     AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
      }
      else {
        varCutPion->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                       AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
      }
     cutPion->AddCut(varCutPion);
     task->AddTrackCut(cutPion);
    
}

//Set electron cut without PID cut for efficiency comparison
//______________________________________________________________________________
void SetJPsiElectronNoPIDCut(AliReducedAnalysisJpsi2ee* task, Bool_t useSPDany /*=kTRUE*/) {
  Bool_t isMC = task->GetRunOverMC();
  AliReducedTrackCut* noPIDCut = new AliReducedTrackCut("noPIDCut","No PID electron selection");
  if (isMC){
    noPIDCut->SetTrackFilterBit(kBasicCut);  // eta cut, ITS and TPC refit , TPCncls already applied
  }
  else {
    noPIDCut->SetUseANDonTrackFilterMap(kFALSE);
    noPIDCut->SetTrackFilterBit(kBasicCut);        // eta cut, ITS and TPC refit , TPCncls already applied
    noPIDCut->SetTrackFilterBit(kPIDopen);
  }
  noPIDCut->AddCut(AliReducedVarManager::kPt, 0.0, 1.0, kTRUE);
  noPIDCut->AddCut(AliReducedVarManager::kDcaXY, -0.5, 0.5);
  noPIDCut->AddCut(AliReducedVarManager::kDcaZ, -2.0, 2.0);
  noPIDCut->AddCut(AliReducedVarManager::kITSchi2, 0., 36.);
  noPIDCut->AddCut(AliReducedVarManager::kTPCchi2, 0., 4.0);
  noPIDCut->AddCut(AliReducedVarManager::kITSnclsShared, 1.9, 6., kTRUE);
  noPIDCut->AddCut(AliReducedVarManager::kTPCNclusBitsFired, 6., 9.);
  noPIDCut->SetRejectKinks();
  if (useSPDany) noPIDCut->SetRequestSPDany();
  task->AddTrackCut(noPIDCut);
}

//__________________________________________________________________________________________
void AddStandardCut(AliReducedAnalysisJpsi2ee* task, Bool_t useSPDany /*=kTRUE*/, Bool_t isCalibrated /*= kFALSE*/) {
   //
   //  This is the standard set of cuts
   //

   Bool_t isMC = task->GetRunOverMC();

   // standard cut
   AliReducedTrackCut* standardCuts = new AliReducedTrackCut("StandardElectron","Electron selection");
   if (isMC){
     standardCuts->SetTrackFilterBit(kBasicCut);  // eta cut, ITS and TPC refit , TPCncls already applied
   }
   else {
     standardCuts->SetUseANDonTrackFilterMap(kFALSE);
     standardCuts->SetTrackFilterBit(kBasicCut);        // eta cut, ITS and TPC refit , TPCncls already applied
     standardCuts->SetTrackFilterBit(kPIDopen);
   }
   //standardCuts->AddCut(AliReducedVarManager::kEta, -0.9,0.9);
   //standardCuts->AddCut(AliReducedVarManager::kTPCncls, 70.,160.0);
   standardCuts->AddCut(AliReducedVarManager::kPt, 0.0, 1.0, kTRUE);
   standardCuts->AddCut(AliReducedVarManager::kDcaXY, -0.2, 0.2); //-0.5, 0.5
   standardCuts->AddCut(AliReducedVarManager::kDcaZ, -0.4,0.4); //-2.0, 2.0


    if(isMC || !isCalibrated) {
        standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -2.0, 3.0);
        standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                            AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
        standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                            AliReducedVarManager::kPin, 0.0, 10000.0);
    }
    else {
       
        standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -2.0, 3.0);
        standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                       AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
        standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                       AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7

  // standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 0.0, 30000.0, kFALSE,
  //                     AliReducedVarManager::kPin, 7.0, 10000.0);   // AliReducedVarManager::kPin > 7
//   standardCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 0.0, 30000.0, kFALSE,
  //                     AliReducedVarManager::kPin, 7.0, 10000.0);   // AliReducedVarManager::kPin > 7
        
    }

   standardCuts->AddCut(AliReducedVarManager::kITSchi2, 0., 36.);
   standardCuts->AddCut(AliReducedVarManager::kTPCchi2, 0., 4.0);
   standardCuts->AddCut(AliReducedVarManager::kITSnclsShared, 1.9, 6., kTRUE);
   standardCuts->AddCut(AliReducedVarManager::kTPCNclusBitsFired, 6., 9.);

   standardCuts->SetRejectKinks();
   if (useSPDany) standardCuts->SetRequestSPDany();



   task->AddTrackCut(standardCuts);
}


//__________________________________________________________________________________________
void SetupDCASystematicsCuts(AliReducedAnalysisJpsi2ee* task, Bool_t addStandardCut /*=kTRUE*/, Bool_t isCalibrated /*= kFALSE*/) {
   //
   // Apply DCA cut variations cuts variations on the electron candidates
   //
   Bool_t isMC = task->GetRunOverMC();

   // common cuts
   AliReducedTrackCut* commonCuts = new AliReducedTrackCut("commonCuts","");
   if (isMC){
     commonCuts->SetTrackFilterBit(kBasicCut);  // eta cut, ITS and TPC refit , TPCncls already applied
   }
   else {
     commonCuts->SetUseANDonTrackFilterMap(kFALSE);
     commonCuts->SetTrackFilterBit(kBasicCut);        // eta cut, ITS and TPC refit , TPCncls already applied
     commonCuts->SetTrackFilterBit(kPIDopen);
   }
   //commonCuts->AddCut(AliReducedVarManager::kEta, -0.9,0.9);
   //commonCuts->AddCut(AliReducedVarManager::kTPCncls, 70.,160.0);
   commonCuts->AddCut(AliReducedVarManager::kPt, 0.0, 1.0, kTRUE);
    if(isMC || !isCalibrated) {
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -2.0, 3.0);
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                            AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                            AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
    }
    else     {
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -2.0, 3.0);
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                       AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                       AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
    }
    
   commonCuts->AddCut(AliReducedVarManager::kITSchi2, 0.0, 36.);
   commonCuts->AddCut(AliReducedVarManager::kTPCchi2, 0., 4.);

   commonCuts->AddCut(AliReducedVarManager::kITSnclsShared, 1.9, 6., kTRUE);
   commonCuts->AddCut(AliReducedVarManager::kTPCNclusBitsFired, 6., 9.);
   commonCuts->SetRejectKinks();
   commonCuts->SetRequestSPDany();

   if(addStandardCut) {
      AddStandardCut(task, kTRUE, isCalibrated);
   }

   // DCAxy cut variations
   const Int_t kNDCAxyCuts = 6;
   Double_t dcaXYcuts[kNDCAxyCuts] = {1.0, 0.5, 0.3, 0.2,0.15,0.1};
  //  DCAz cut variations
   const Int_t kNDCAzCuts = 5;
   Double_t dcaZcuts[kNDCAzCuts] = {3.0, 2.0,1.0, 0.5, 0.4};


   for(Int_t ixy=0;ixy<kNDCAxyCuts; ++ixy) {
      AliReducedTrackCut* xyCut = new AliReducedTrackCut(Form("DCAxy%.2f", dcaXYcuts[ixy]),"");
      xyCut->AddCut(AliReducedVarManager::kDcaXY, -1.0*dcaXYcuts[ixy], dcaXYcuts[ixy]);
      for(Int_t iz=0;iz<kNDCAzCuts; ++iz) {
         if(ixy==0 && iz==0) continue;
         AliReducedTrackCut* zCut = new AliReducedTrackCut(Form("DCAz%.2f", dcaZcuts[iz]),"");
         zCut->AddCut(AliReducedVarManager::kDcaZ, -1.0*dcaZcuts[iz], dcaZcuts[iz]);

         AliReducedCompositeCut* cut = new AliReducedCompositeCut(Form("DCAxy%.0fDCAz%.0f", dcaXYcuts[ixy]*100, dcaZcuts[iz]*100), "");
         cut->AddCut(commonCuts);
         cut->AddCut(xyCut);
         cut->AddCut(zCut);
         task->AddTrackCut(cut);
      }
   }
}

//__________________________________________________________________________________________
void SetupTrackingSystematicCuts(AliReducedAnalysisJpsi2ee* task, Bool_t addStandardCut /*=kTRUE*/, Bool_t isCalibrated /*= kFALSE*/) {
   //
   // Apply tracking cuts variations on the electron candidates
   //
   Bool_t isMC = task->GetRunOverMC();

   // common cuts
   AliReducedTrackCut* commonCuts = new AliReducedTrackCut("commonCuts","");
   if (isMC){
     commonCuts->SetTrackFilterBit(kBasicCut);  // eta cut, ITS and TPC refit , TPCncls already applied
   }
   else {
     commonCuts->SetUseANDonTrackFilterMap(kFALSE);
     commonCuts->SetTrackFilterBit(kBasicCut);        // eta cut, ITS and TPC refit , TPCncls already applied
     commonCuts->SetTrackFilterBit(kPIDopen);
   }
   commonCuts->AddCut(AliReducedVarManager::kPt, 0.0, 1.0, kTRUE);
   //commonCuts->AddCut(AliReducedVarManager::kEta, -0.9,0.9);
   //commonCuts->AddCut(AliReducedVarManager::kTPCncls, 70.,160.0);
   commonCuts->AddCut(AliReducedVarManager::kTPCNclusBitsFired, 6., 9.);
    if (isMC || (!isCalibrated)) {
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron), -2.0, 3.0);
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                          AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                          AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
    }
    else {
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron), -2.0, 3.0);
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion), 3., 30000.0, kFALSE,
                          AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
        commonCuts->AddCut(static_cast<AliReducedVarManager::Variables>(AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton), 3., 30000.0, kFALSE,
                          AliReducedVarManager::kPin, 0.0, 10000.0);   // AliReducedVarManager::kPin < 7
    }
   commonCuts->AddCut(AliReducedVarManager::kITSchi2, 0.0, 36.);
   commonCuts->AddCut(AliReducedVarManager::kTPCchi2, 0., 4.);
   commonCuts->SetRejectKinks();

   if(addStandardCut) {
      AddStandardCut(task, kTRUE, isCalibrated);
   }

   const Int_t kNITSclsReqCuts = 2;      // SPDany, SPDfirst,
   AliReducedTrackCut* itsClsReqCuts[kNITSclsReqCuts];
   itsClsReqCuts[0] = new AliReducedTrackCut("SPDany","");
   itsClsReqCuts[0]->SetRequestSPDany();
   itsClsReqCuts[1] = new AliReducedTrackCut("SPDfirst","");
   itsClsReqCuts[1]->SetRequestSPDfirst();

   const Int_t kNITSsharedClsCuts = 4;      // ITSshared0, itsShared1, itsShared2, ITSsharedAny
   AliReducedTrackCut* itsSharedClsCuts[kNITSsharedClsCuts];
   itsSharedClsCuts[1] = new AliReducedTrackCut("ITSshared0","");
   itsSharedClsCuts[1]->AddCut(AliReducedVarManager::kITSnclsShared, 0.9, 6., kTRUE);   // no shared cls allowed
   itsSharedClsCuts[0] = new AliReducedTrackCut("ITSshared1","");
   itsSharedClsCuts[0]->AddCut(AliReducedVarManager::kITSnclsShared, 1.9, 6., kTRUE);   // 1 shared cls allowed
   itsSharedClsCuts[2] = new AliReducedTrackCut("ITSshared2","");
   itsSharedClsCuts[2]->AddCut(AliReducedVarManager::kITSnclsShared, 2.9, 6., kTRUE);   // 2 shared cls allowed
   itsSharedClsCuts[3] = new AliReducedTrackCut("ITSshared3","");
   itsSharedClsCuts[3]->AddCut(AliReducedVarManager::kITSnclsShared, 0., 6.);   // no shared cls cut


      const Int_t kNDCACuts = 3;
      AliReducedTrackCut* dcaCuts[kNDCACuts];
      dcaCuts[0] = new AliReducedTrackCut("DCAxy20DCAz4","");
      dcaCuts[0]->AddCut(AliReducedVarManager::kDcaXY, -0.2, 0.2);
      dcaCuts[0]->AddCut(AliReducedVarManager::kDcaZ, -0.4, 0.4);
      dcaCuts[1] = new AliReducedTrackCut("DCAxy15DCAz30","");
      dcaCuts[1]->AddCut(AliReducedVarManager::kDcaXY, -0.15, 0.15);
      dcaCuts[1]->AddCut(AliReducedVarManager::kDcaZ, -0.3, 0.3);
      dcaCuts[2] = new AliReducedTrackCut("DCAxy50DCAz100","");
      dcaCuts[2]->AddCut(AliReducedVarManager::kDcaXY, -0.5, 0.5);
      dcaCuts[2]->AddCut(AliReducedVarManager::kDcaZ, -1.0, 1.0);
   /*
      const Int_t kNDCACuts = 3;
      AliReducedTrackCut* dcaCuts[kNDCACuts];
      dcaCuts[0] = new AliReducedTrackCut("DCAxy20DCAz40","");
      dcaCuts[0]->AddCut(AliReducedVarManager::kDcaXY, -0.2, 0.2);
      dcaCuts[0]->AddCut(AliReducedVarManager::kDcaZ, -0.4, 0.4);
      dcaCuts[1] = new AliReducedTrackCut("DCAxy15DCAz30","");
      dcaCuts[1]->AddCut(AliReducedVarManager::kDcaXY, -0.15, 0.15);
      dcaCuts[1]->AddCut(AliReducedVarManager::kDcaZ, -0.3, 0.3);
      dcaCuts[2] = new AliReducedTrackCut("DCAxy50DCAz100","");
      dcaCuts[2]->AddCut(AliReducedVarManager::kDcaXY, -0.5, 0.5);
      dcaCuts[2]->AddCut(AliReducedVarManager::kDcaZ, -1.0, 1.0);
*/

   for(Int_t i=0;i<kNITSclsReqCuts;++i) {
      for(Int_t j=0;j<kNITSsharedClsCuts;++j) {
         for(Int_t k=0;k<kNDCACuts;++k) {
          //  if(addStandardCut && i==0 && j==0 && k==0) continue;     // this is the standard cut and was already added

            AliReducedCompositeCut* cut = new AliReducedCompositeCut(Form("%s_%s_%s", itsClsReqCuts[i]->GetName(), itsSharedClsCuts[j]->GetName(), dcaCuts[k]->GetName()), "");
            cut->AddCut(commonCuts);
            cut->AddCut(itsClsReqCuts[i]);
            cut->AddCut(itsSharedClsCuts[j]);
            cut->AddCut(dcaCuts[k]);
            task->AddTrackCut(cut);
         }
      }
   }
}

//_________________________________________________________________
void SetupMCsignals(AliReducedAnalysisJpsi2ee* task) {
   //
   // setup the needed signals for efficiency calculations
   //
   // MC truth info for reconstructed electron candidates
   AliReducedTrackCut* trueElectron = new AliReducedTrackCut("TrueElectron", "reconstructed electrons with MC truth");
   trueElectron->SetMCFilterBit(kJpsiDecayElectron);
   task->AddLegCandidateMCcut(trueElectron);

   AliReducedTrackCut* trueElectronNonPrompt = new AliReducedTrackCut("TrueElectronNonPrompt", "reconstructed electrons with MC truth");
   trueElectronNonPrompt->SetMCFilterBit(kJpsiNonPromptDecayElectron);
   task->AddLegCandidateMCcut(trueElectronNonPrompt);

   AliReducedTrackCut* trueElectronPrompt = new AliReducedTrackCut("TrueElectronPrompt", "reconstructed electrons with MC truth");
   trueElectronPrompt->SetMCFilterBit(kJpsiPromptDecayElectron);
   task->AddLegCandidateMCcut(trueElectronPrompt);

   // MC truth selections(s) for the J/psi mother and electron daughters
   AliReducedTrackCut* mcTruthJpsi = new AliReducedTrackCut("mcTruthJpsi", "Pure MC truth J/psi");
   mcTruthJpsi->SetMCFilterBit(kJpsiInclusive);
   mcTruthJpsi->SetApplyReweightMCpt(kFALSE);
   mcTruthJpsi->AddCut(AliReducedVarManager::kRap, -0.9, 0.9);

   AliReducedTrackCut* mcTruthJpsiElectron = new AliReducedTrackCut("mcTruthJpsiElectron", "Pure MC truth electron from J/psi");
   mcTruthJpsiElectron->SetMCFilterBit(kJpsiDecayElectron);
   mcTruthJpsiElectron->AddCut(AliReducedVarManager::kEta, -0.9, 0.9);
   mcTruthJpsiElectron->AddCut(AliReducedVarManager::kPt, 1.0, 100.0);
   task->AddJpsiMotherMCCut(mcTruthJpsi, mcTruthJpsiElectron);

   AliReducedTrackCut* mcTruthJpsiNonPrompt = new AliReducedTrackCut("mcTruthJpsiNonPrompt", "Pure MC truth J/psi");
   mcTruthJpsiNonPrompt->SetMCFilterBit(kJpsiNonPrompt);
   mcTruthJpsiNonPrompt->SetApplyReweightMCpt(kFALSE);
   mcTruthJpsiNonPrompt->AddCut(AliReducedVarManager::kRap, -0.9, 0.9);
   AliReducedTrackCut* mcTruthJpsiElectronNonPrompt = new AliReducedTrackCut("mcTruthJpsiElectronNonPrompt", "Pure MC truth electron from J/psi");
   mcTruthJpsiElectronNonPrompt->SetMCFilterBit(kJpsiNonPromptDecayElectron);
   mcTruthJpsiElectronNonPrompt->AddCut(AliReducedVarManager::kEta, -0.9, 0.9);
   mcTruthJpsiElectronNonPrompt->AddCut(AliReducedVarManager::kPt, 1.0, 100.0);
   task->AddJpsiMotherMCCut(mcTruthJpsiNonPrompt, mcTruthJpsiElectronNonPrompt);

   AliReducedTrackCut* mcTruthJpsiPrompt = new AliReducedTrackCut("mcTruthJpsiPrompt", "Pure MC truth J/psi");
   mcTruthJpsiPrompt->SetMCFilterBit(kJpsiPrompt);
   mcTruthJpsiPrompt->SetApplyReweightMCpt(kTRUE); //Apply reweighting only for prompt J/psi
   mcTruthJpsiPrompt->AddCut(AliReducedVarManager::kRap, -0.9, 0.9);
   AliReducedTrackCut* mcTruthJpsiElectronPrompt = new AliReducedTrackCut("mcTruthJpsiElectronPrompt", "Pure MC truth electron from J/psi");
   mcTruthJpsiElectronPrompt->SetMCFilterBit(kJpsiPromptDecayElectron);
   mcTruthJpsiElectronPrompt->AddCut(AliReducedVarManager::kEta, -0.9, 0.9);
   mcTruthJpsiElectronPrompt->AddCut(AliReducedVarManager::kPt, 1.0, 100.0);
   task->AddJpsiMotherMCCut(mcTruthJpsiPrompt, mcTruthJpsiElectronPrompt);

}


//_________________________________________________________________
void SetupMixingHandler(AliReducedAnalysisJpsi2ee* task) {
   //
   // setup the mixing handler
   //
   AliMixingHandler* handler = task->GetMixingHandler();
   handler->SetPoolDepth(100);
   handler->SetMixingThreshold(1.0);
   handler->SetDownscaleEvents(1);
   handler->SetDownscaleTracks(1);


   handler->AddMixingVariable(AliReducedVarManager::kVtxZ, gkNZBins, gZBinLims);
   //handler->AddMixingVariable(AliReducedVarManager::kSPDntracklets, gkNSPDtrkBins, gSPDtrkBinLims);
}


//_________________________________________________________________
void SetupHistogramManager(AliReducedAnalysisJpsi2ee* task, TString prod /*="LHC10h"*/) {
  //
  // setup the histograms manager
  //
  AliReducedVarManager::SetDefaultVarNames();

  DefineHistograms(task, prod);

  AliReducedVarManager::SetUseVars((Bool_t*)task->GetHistogramManager()->GetUsedVars());
}


//_________________________________________________________________
void DefineHistograms(AliReducedAnalysisJpsi2ee* task, TString prod /*="LHC10h"*/) {
  //
  // define histograms
  // NOTE: The DefineHistograms need to be called after the track cuts are defined because the name of the cuts
  //           are used in the histogram lists
   // NOTE: The name of the pair histogram lists for event mixing need to contain "PairMEPP", "PairMEPM", "PairMEMM", in their name, see below.
   //  TODO: make needed changes such that this becomes less prone to mistakes

  AliHistogramManager* man = task->GetHistogramManager();

  TString histClasses = "";
  histClasses += "Event_BeforeCuts;";
  histClasses += "Event_AfterCuts;";
  if(!task->GetRunOverMC()) {
    histClasses += "EventTag_BeforeCuts;";
    histClasses += "EventTag_AfterCuts;";
    histClasses += "EventTriggers_BeforeCuts;";
    histClasses += "EventTriggers_AfterCuts;";
  }
  if(task->GetLoopOverTracks())
    histClasses += "Track_BeforeCuts;";
  if(!task->GetRunOverMC()) {
    histClasses += "TrackStatusFlags_BeforeCuts;";
  }
  if(task->GetLoopOverTracks()) {
    histClasses += "TrackITSclusterMap_BeforeCuts;";
    histClasses += "TrackITSsharedClusterMap_BeforeCuts;";
    histClasses += "TrackTPCclusterMap_BeforeCuts;";
  }
  if(task->GetRunOverMC()) {
     for(Int_t mcSel=0; mcSel<task->GetNJpsiMotherMCCuts(); ++mcSel) {
        histClasses += Form("%s_PureMCTruth_BeforeSelection;", task->GetJpsiMotherMCcutName(mcSel));
        histClasses += Form("%s_PureMCTruth_AfterSelection;", task->GetJpsiMotherMCcutName(mcSel));
     }
  }
  if(task->GetLoopOverTracks()) {
    for(Int_t i=0; i<task->GetNTrackCuts(); ++i) {
      TString cutName = task->GetTrackCutName(i);
      histClasses += Form("Track_%s;", cutName.Data());
      if(!task->GetRunOverMC()) {
        histClasses += Form("TrackStatusFlags_%s;", cutName.Data());
      }
      histClasses += Form("TrackITSclusterMap_%s;", cutName.Data());
      histClasses += Form("TrackITSsharedClusterMap_%s;", cutName.Data());
      histClasses += Form("TrackTPCclusterMap_%s;", cutName.Data());
      if(task->GetRunOverMC()) {
         for(Int_t mcSel=0; mcSel<task->GetNLegCandidateMCcuts(); ++mcSel) {
            histClasses += Form("Track_%s_%s;", cutName.Data(), task->GetLegCandidateMCcutName(mcSel));
            histClasses += Form("TrackStatusFlags_%s_%s;", cutName.Data(), task->GetLegCandidateMCcutName(mcSel));
            histClasses += Form("TrackITSclusterMap_%s_%s;", cutName.Data(), task->GetLegCandidateMCcutName(mcSel));
            histClasses += Form("TrackITSsharedClusterMap_%s_%s;", cutName.Data(), task->GetLegCandidateMCcutName(mcSel));
            histClasses += Form("TrackTPCclusterMap_%s_%s;", cutName.Data(), task->GetLegCandidateMCcutName(mcSel));
         }
      }
      if(task->GetRunPairing()) {
         if(!task->GetRunOverMC()) {
            if(!task->GetRunLikeSignPairing())
               histClasses += Form("PairSEPM_%s;", cutName.Data());
            else
               histClasses += Form("PairSEPP_%s;PairSEPM_%s;PairSEMM_%s;", cutName.Data(), cutName.Data(), cutName.Data());
         }
          else if (!cutName.CompareTo("StandardElectron"))
              histClasses += Form("PairSEPM_%s;", cutName.Data());
         if(!task->GetRunOverMC())
            histClasses += Form("PairMEPP_%s;PairMEPM_%s;PairMEMM_%s;", cutName.Data(), cutName.Data(), cutName.Data());
         if(task->GetRunOverMC()) {
            for(Int_t mcSel=0; mcSel<task->GetNLegCandidateMCcuts(); ++mcSel)
               histClasses += Form("PairSEPM_%s_%s;", cutName.Data(), task->GetLegCandidateMCcutName(mcSel));
         }
      }
    }
  }

  AliReducedVarManager::SetRunNumbers(gRunList);

  const Int_t kNBCBins = 3600;
  Double_t bcHistRange[2] = {-0.5,3599.5};

  // set the mass bin limits
  for(Int_t i=0; i<gkNMassBins;++i) gMassBins[i] = 1.4+i*0.04;

  // set the pt bin limits for MC
  for(Int_t i=0; i<=gkNPtBins2D;++i) gPtLims2D[i] = 0.0+i*0.1;

  // set the pt bin limits for MC
  for(Int_t i=0; i<=gkNPtBinsMC;++i) gPtLimsMC[i] = 0.0+i*0.05;

  TString classesStr(histClasses);
  TObjArray* arr=classesStr.Tokenize(";");

  cout << "Histogram classes included in the Histogram Manager" << endl;
  for(Int_t iclass=0; iclass<arr->GetEntries(); ++iclass) {
    TString classStr = arr->At(iclass)->GetName();

    
      const Int_t kNVars = 4; //AliReducedVarManager::kVtxZ,
      Int_t vars[kNVars] = {AliReducedVarManager::kMass, AliReducedVarManager::kPt,AliReducedVarManager::kVtxZ, AliReducedVarManager::kRapAbs};
      
      Int_t varsMC[kNVars] = {AliReducedVarManager::kMassMC, AliReducedVarManager::kPtMC,AliReducedVarManager::kVtxZ, AliReducedVarManager::kRapMCAbs};
      
      //Int_t vars[kNVars] = {AliReducedVarManager::kMass, AliReducedVarManager::kPt,AliReducedVarManager::kVtxZ, AliReducedVarManager::kRap};
      
      //Int_t varsMC[kNVars] = {AliReducedVarManager::kMassMC, AliReducedVarManager::kPtMC,AliReducedVarManager::kVtxZ, AliReducedVarManager::kRapMC};
      
      //Int_t vars[3] = {AliReducedVarManager::kMass, AliReducedVarManager::kPt, AliReducedVarManager::kSPDntracklets};
      //Int_t vars[4] = {AliReducedVarManager::kMass, AliReducedVarManager::kPt, AliReducedVarManager::kVtxZ, AliReducedVarManager::kSPDntracklets};
      
      TArrayD pairHistBinLimits[kNVars];
      pairHistBinLimits[0] = TArrayD(gkNMassBins, gMassBins);
      if(task->GetRunOverMC()) {
          pairHistBinLimits[1] = TArrayD(gkNPtBinsMC+1, gPtLimsMC);
          pairHistBinLimits[2] = TArrayD(gkNZBinsMC, gZBinLimsMC);
          pairHistBinLimits[3] = TArrayD(gkNRapBins,gRapBinLims);
      }
      else {
          pairHistBinLimits[1] = TArrayD(gkNPtBins, gPtLims);
          pairHistBinLimits[2] = TArrayD(gkNZBins, gZBinLims);
          pairHistBinLimits[3] = TArrayD(gkNRapBins,gRapBinLims);
      }
      //pairHistBinLimits[3] = TArrayD(gkNSPDtrkBins, gSPDtrkBinLims);
      

      
    if(classStr.Contains("PureMCTruth_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;

       man->AddHistogram(classStr.Data(), "PairInvMass", "Differential pair inv. mass", kNVars, varsMC, pairHistBinLimits);
       man->AddHistogram(classStr.Data(), "MassMC_Pt", "", kFALSE, gkNMassBins-1, gMassBins, AliReducedVarManager::kMassMC, gkNPtBins-1, gPtLims, AliReducedVarManager::kPtMC);

       man->AddHistogram(classStr.Data(), "MassMC", "MC mass", kFALSE, 200, 0., 5.0, AliReducedVarManager::kMassMC);
       man->AddHistogram(classStr.Data(), "RapidityMC", "MC rapidity", kFALSE, 48, -1.2, 1.2, AliReducedVarManager::kRapMC);
       man->AddHistogram(classStr.Data(), "PtMC", "p_{T} MC", kFALSE, gkNPtBinsMC, gPtLimsMC, AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "PtMC_RunID", "p_{T} MC vs Run", kFALSE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID,
                                                                           600, 0., 30.0, AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "PtMC_coarse", "p_{T} MC", kFALSE, 20, 0., 20.0, AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "PhiMC", "MC #varphi", kFALSE, 100, 0., 6.3, AliReducedVarManager::kPhiMC);
       man->AddHistogram(classStr.Data(), "EtaMC", "MC #eta", kFALSE, 100, -1.5, 1.5, AliReducedVarManager::kEtaMC);
       man->AddHistogram(classStr.Data(), "PtMC_RapMC", "", kFALSE, 100, -1.2, 1.2, AliReducedVarManager::kRapMC, 100, 0., 15., AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "CosThetaStarCS", "cos(#theta^{*})_{CS}", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaCS);
       man->AddHistogram(classStr.Data(), "CosThetaStarCS_ptMC", "cos(#theta^{*})_{CS} vs MC pt", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaCS, 400, 0., 20., AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "CosThetaStarHE", "cos(#theta^{*})_{HE}", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaHE);
       man->AddHistogram(classStr.Data(), "CosThetaStarHE_ptMC", "cos(#theta^{*})_{HE} vs MC pt", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaHE, 400, 0., 20., AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "CosThetaStarHE_ptMC_coarse", "cos(#theta^{*})_{HE} vs MC pt", kFALSE, 10, -1.0, 1.0, AliReducedVarManager::kPairThetaHE, 20, 0., 20., AliReducedVarManager::kPtMC);
       man->AddHistogram(classStr.Data(), "PhiStarCS", "#varphi^{*}_{CS}", kFALSE, 66, -3.3, 3.3, AliReducedVarManager::kPairPhiCS);
       man->AddHistogram(classStr.Data(), "PhiStarHE", "#varphi^{*}_{HE}", kFALSE, 66, -3.3, 3.3, AliReducedVarManager::kPairPhiHE);


       continue;
    }

    // Event wise histograms
    if(classStr.Contains("EventTag_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;
       TString tagNames = "";
       tagNames += "AliAnalysisUtils 2013 selection;";
       tagNames += "AliAnalysisUtils MV pileup;";
       tagNames += "AliAnalysisUtils MV pileup, no BC check;";
       tagNames += "AliAnalysisUtils MV pileup, min wght dist 10;";
       tagNames += "AliAnalysisUtils MV pileup, min wght dist 5;";
       tagNames += "IsPileupFromSPD(3,0.6,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(4,0.6,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(5,0.6,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(6,0.6,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(3,0.8,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(4,0.8,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(5,0.8,3.,2.,5.);";
       tagNames += "IsPileupFromSPD(6,0.8,3.,2.,5.);";
       tagNames += "vtx distance selected;";
       tagNames += "unbiased event;";
       man->AddHistogram(classStr.Data(), "EventTags", "Event tags", kFALSE,
                         20, -0.5, 19.5, AliReducedVarManager::kEventTag, 0, 0.0, 0.0, AliReducedVarManager::kNothing, 0, 0.0, 0.0, AliReducedVarManager::kNothing, tagNames.Data());
       man->AddHistogram(classStr.Data(), "EventTags_PhysSelection", "Event tags", kFALSE,
                         20, -0.5, 19.5, AliReducedVarManager::kEventTag, 2,-0.5,1.5,AliReducedVarManager::kIsPhysicsSelection, 0, 0.0, 0.0, AliReducedVarManager::kNothing, tagNames.Data(), "off;on");
       man->AddHistogram(classStr.Data(), "EventTags_SPDtracklets0_Run_prof", "<SPD tracklets> vs run", kTRUE,
                         gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 20, -0.5, 19.5, AliReducedVarManager::kEventTag, 300, 0., 300., AliReducedVarManager::kSPDntracklets, gRunList.Data(), tagNames.Data());
       man->AddHistogram(classStr.Data(), "EventTags_VZEROMult_Run_prof", "<VZERO mult> vs run", kTRUE,
                         gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 20, -0.5, 19.5, AliReducedVarManager::kEventTag, 300, 0., 300., AliReducedVarManager::kVZEROTotalMult, gRunList.Data(), tagNames.Data());
       man->AddHistogram(classStr.Data(), "EventTags_NTotalTracksAnalyzed_Run_prof", "<total tracks analyzed> vs run", kTRUE,
                         gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 20, -0.5, 19.5, AliReducedVarManager::kEventTag, 300, 0., 300., AliReducedVarManager::kNtracksAnalyzed, gRunList.Data(), tagNames.Data());
       man->AddHistogram(classStr.Data(), "EventTags_NTotalPairsAnalyzed_Run_prof", "<total tracks analyzed> vs run", kTRUE,
                         gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 20, -0.5, 19.5, AliReducedVarManager::kEventTag, 300, 0., 300., AliReducedVarManager::kNpairsSelected, gRunList.Data(), tagNames.Data());
       man->AddHistogram(classStr.Data(), "EventTags_VtxZ_Run", "VtxZ vs run", kFALSE,
                         gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 20, -0.5, 19.5, AliReducedVarManager::kEventTag, 300, -15., 15., AliReducedVarManager::kVtxZ, gRunList.Data(), tagNames.Data());
       //man->AddHistogram(classStr.Data(), "EventTags_CentVZERO", "Event tags vs VZERO centrality", kFALSE,
       //                  20, -0.5, 19.5, AliReducedVarManager::kEventTag, 9, 0.0, 90.0, AliReducedVarManager::kCentVZERO, 0, 0.0, 0.0, AliReducedVarManager::kNothing, tagNames.Data());
       continue;
    }

    if(classStr.Contains("EventTriggers_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;
       TString triggerNames = "";
       for(Int_t i=0; i<64; ++i) {triggerNames += AliReducedVarManager::fgkOfflineTriggerNames[i]; triggerNames+=";";}

       man->AddHistogram(classStr.Data(), "Triggers2", "", kFALSE,
                         64, -0.5, 63.5, AliReducedVarManager::kOnlineTriggerFired2, 0, 0.0, 0.0, AliReducedVarManager::kNothing, 0, 0.0, 0.0, AliReducedVarManager::kNothing, triggerNames.Data());
       //man->AddHistogram(classStr.Data(), "CentVZERO_Triggers2", "", kFALSE,
       //                  64, -0.5, 63.5, AliReducedVarManager::kOnlineTriggerFired2, 9, 0.0, 90.0, AliReducedVarManager::kCentVZERO, 0, 0.0, 0.0, AliReducedVarManager::kNothing, triggerNames.Data());
       continue;
    }

    if(classStr.Contains("Event_")) {
      man->AddHistClass(classStr.Data());
      cout << classStr.Data() << endl;
      //run numbers
      man->AddHistogram(classStr.Data(),"RunNo","Run numbers",kFALSE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 0, 0.0, 0.0, AliReducedVarManager::kNothing, 0, 0.,0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"VtxX","Vtx X",kFALSE,500,-1.0,1.0,AliReducedVarManager::kVtxX);
      man->AddHistogram(classStr.Data(),"VtxX_vs_Run_prof", "Vtx <X>", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kVtxX, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"VtxY","Vtx Y",kFALSE,500,-1.0,1.0,AliReducedVarManager::kVtxY);
      man->AddHistogram(classStr.Data(),"VtxY_vs_Run_prof", "Vtx <Y>", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kVtxY, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"VtxXY","Vtx X vs vtx Y",kFALSE,100,0.,0.2,AliReducedVarManager::kVtxX, 100,0.3,0.45,AliReducedVarManager::kVtxY);
      man->AddHistogram(classStr.Data(),"VtxXZ","Vtx X vs vtx Z",kFALSE, 100,-10.,10.,AliReducedVarManager::kVtxZ, 100,0.0,0.2,AliReducedVarManager::kVtxX);
      man->AddHistogram(classStr.Data(),"VtxYZ","Vtx Y vs vtx Z",kFALSE, 100,-10.,10.,AliReducedVarManager::kVtxZ, 100,0.3,0.45,AliReducedVarManager::kVtxY);
      man->AddHistogram(classStr.Data(),"VtxZ","Vtx Z",kFALSE,200,-10.,10.,AliReducedVarManager::kVtxZ);
      man->AddHistogram(classStr.Data(),"VtxZ_vs_Run_prof", "Vtx <Z>", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kVtxZ, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"DeltaVtxZtpc","Z - Z_{TPC}",kFALSE,300,-15.,15.,AliReducedVarManager::kDeltaVtxZ);
      man->AddHistogram(classStr.Data(),"DeltaVtxztpc_vs_Run_prof", "<Z-Z_{TPC}>", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kDeltaVtxZ, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"DeltaVtxZtpc_nTPCout","Z - Z_{TPC} vs nTPCout tracks",kFALSE,
                        100,0.,1200.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout,                        100,-15.,15.,AliReducedVarManager::kDeltaVtxZ);

      // pile-up
      man->AddHistogram(classStr.Data(), "NTracksTPCoutFromPileup", "", kFALSE,
                        2000, -10000., 30000.,                        AliReducedVarManager::kNTracksTPCoutFromPileup);
      man->AddHistogram(classStr.Data(), "NTracksTPCoutFromPileup_RunNo_QA", "", kTRUE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        2000, -10000., 30000.,                        AliReducedVarManager::kNTracksTPCoutFromPileup,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());
      man->AddHistogram(classStr.Data(), "SPDPileUp_RunNo_QA", "SPD pileup per run", kFALSE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        100, 0., 10.,                                 AliReducedVarManager::kIsSPDPileup,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());
      man->AddHistogram(classStr.Data(), "MVPileUp_RunNo_QA", "multi vertexer pileup per run", kTRUE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        100, 0., 10.,                                 AliReducedVarManager::kIsPileupMV,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());



      man->AddHistogram(classStr.Data(),"SPDntracklets", "SPD #tracklets in |#eta|<1.0", kFALSE, 300, 0., 300., AliReducedVarManager::kSPDntracklets);
      man->AddHistogram(classStr.Data(),"SPDntracklets_vs_Run_prof", "SPD #tracklets in |#eta|<1.0", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kSPDntracklets, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"SPDfiredChipsL1", "SPD fired chips in layer 1", kFALSE, 300, 0., 300., AliReducedVarManager::kSPDFiredChips+0);
      man->AddHistogram(classStr.Data(),"SPDfiredChipsL2", "SPD fired chips in layer 2", kFALSE, 300, 0., 300., AliReducedVarManager::kSPDFiredChips+1);
      man->AddHistogram(classStr.Data(),"SPDnSigleClusters", "SPD #single clusters", kFALSE, 300, 0., 300., AliReducedVarManager::kSPDnSingleClusters);
      for(Int_t il=0; il<6;++il)
         man->AddHistogram(classStr.Data(),Form("ITSnClustersLayer%d",il+1), Form("Number of clusters in ITS layer %d", il+1), kFALSE, 300, 0., 300., AliReducedVarManager::kITSnClusters+il);

      man->AddHistogram(classStr.Data(),"SPDntracklets_SPDfiredChipsL1", "SPD #tracklets in |#eta|<1.0 vs SPD fired chips in L1", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kSPDFiredChips+0);
      man->AddHistogram(classStr.Data(),"SPDntracklets_SPDfiredChipsL2", "SPD #tracklets in |#eta|<1.0 vs SPD fired chips in L2", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kSPDFiredChips+1);
      man->AddHistogram(classStr.Data(),"SPDntracklets_SPDnSingleClusters", "SPD #tracklets in |#eta|<1.0 vs SPD single clusters", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kSPDnSingleClusters);
      man->AddHistogram(classStr.Data(),"SPDntracklets_ITSclsLayer1", "SPD #tracklets in |#eta|<1.0 vs ITS clusters in L1", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kITSnClusters+0);
      man->AddHistogram(classStr.Data(),"SPDntracklets_ITSclsLayer2", "SPD #tracklets in |#eta|<1.0 vs ITS clusters in L2", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kITSnClusters+1);
      man->AddHistogram(classStr.Data(),"SPDntracklets_ITSclsLayer5", "SPD #tracklets in |#eta|<1.0 vs ITS clusters in L5", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kITSnClusters+4);
      man->AddHistogram(classStr.Data(),"SPDntracklets_ITSclsLayer6", "SPD #tracklets in |#eta|<1.0 vs ITS clusters in L6", kFALSE, 200, 0., 200., AliReducedVarManager::kSPDntracklets, 200, 0., 200., AliReducedVarManager::kITSnClusters+5);


      man->AddHistogram(classStr.Data(),"VZEROmult", "", kFALSE, 200, 0.0, 2000., AliReducedVarManager::kVZEROTotalMult);
      man->AddHistogram(classStr.Data(),"VZEROmult_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kVZEROTotalMult, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"VZEROmult_VtxContributors", "", kFALSE,
		   200, 0.0, 2000., AliReducedVarManager::kVZEROTotalMult, 200, 0.0, 200., AliReducedVarManager::kNVtxContributors);
      man->AddHistogram(classStr.Data(),"VZEROmult_SPDntracklets", "", kFALSE,
                        200, 0.0, 200., AliReducedVarManager::kSPDntracklets, 200, 0.0, 2000., AliReducedVarManager::kVZEROTotalMult);
      man->AddHistogram(classStr.Data(),"IsPhysicsSelection","Physics selection flag",kFALSE,
                        2,-0.5,1.5,AliReducedVarManager::kIsPhysicsSelection, 0,0.0,0.0,AliReducedVarManager::kNothing, 0,0.0,0.0,AliReducedVarManager::kNothing, "off;on");

      man->AddHistogram(classStr.Data(),"NPosTracksAnalyzed","#positrons per event",kFALSE,10,0.,10.,AliReducedVarManager::kNtracksPosAnalyzed);
      man->AddHistogram(classStr.Data(),"NPosTracksAnalyzed_vs_Run_prof", "# positrons per event", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kNtracksPosAnalyzed, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"NNegTracksAnalyzed","#electrons per event",kFALSE,10,0.,10.,AliReducedVarManager::kNtracksNegAnalyzed);
      man->AddHistogram(classStr.Data(),"NNegTracksAnalyzed_vs_Run_prof", "# electrons per event", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kNtracksNegAnalyzed, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"NTotalTracksAnalyzed","#leg candidates per event",kFALSE,10,0.,10.,AliReducedVarManager::kNtracksAnalyzed);
      man->AddHistogram(classStr.Data(),"NTotalTracksAnalyzed_vs_Run_prof", "# leg candidates per event", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kNtracksAnalyzed, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"NTotalPairsAnalyzed","#dielectron candidates per event",kFALSE,10,0.,10.,AliReducedVarManager::kNpairsSelected);
      man->AddHistogram(classStr.Data(),"NTotalPairsAnalyzed_vs_Run_prof", "#dielectron candidates per event", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kNpairsSelected, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());

      man->AddHistogram(classStr.Data(),"NTracksTPCout","",kFALSE,200,0.,1200.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout);
      man->AddHistogram(classStr.Data(),"NTracksTPCout_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"NTracksTPCout_vs_Run", "", kFALSE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 100, 0., 1500., AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"NTracksTPCout_VZEROmult","",kFALSE,200,0.,1200.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 200, 0., 2000., AliReducedVarManager::kVZEROTotalMult);
      man->AddHistogram(classStr.Data(),"NTracksTPCout_SPDtracklets","",kFALSE,200,0.,1200.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 200, 0., 200., AliReducedVarManager::kSPDntracklets);


      man->AddHistogram(classStr.Data(),"NTracksAnalyzed_VZEROmult","",kFALSE,10,0.,10.,AliReducedVarManager::kNtracksAnalyzed, 200, 0., 2000., AliReducedVarManager::kVZEROTotalMult);
      man->AddHistogram(classStr.Data(),"NTracksAnalyzed_VZEROmult_prof","",kTRUE,200, 0., 2000., AliReducedVarManager::kVZEROTotalMult, 10,0.,10.,AliReducedVarManager::kNtracksAnalyzed);
      man->AddHistogram(classStr.Data(),"NPairsAnalyzed_VZEROmult_prof","",kTRUE,200, 0., 2000., AliReducedVarManager::kVZEROTotalMult, 10,0.,10.,AliReducedVarManager::kNpairsSelected);
      man->AddHistogram(classStr.Data(),"NTracksAnalyzed_NTracksTPCout_prof","",kTRUE, 30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 10,0.,10.,AliReducedVarManager::kNtracksAnalyzed);
      man->AddHistogram(classStr.Data(),"NPairsAnalyzed_NTracksTPCout_prof","",kTRUE, 30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 10,0.,10.,AliReducedVarManager::kNpairsSelected);
      man->AddHistogram(classStr.Data(),"NTracksTPCoutVsVZEROmult","",kFALSE,200,0.,20.,AliReducedVarManager::kNTracksTPCoutVsVZEROTotalMult);
      man->AddHistogram(classStr.Data(),"NTracksTPCoutVsVZEROmult_VZEROmult","",kFALSE, 100, 0., 2000., AliReducedVarManager::kVZEROTotalMult, 100,0.,20.,AliReducedVarManager::kNTracksTPCoutVsVZEROTotalMult);
      man->AddHistogram(classStr.Data(),"NTracksAnalyzed_RunNo_prof","",kTRUE, gkNRuns, -0.5, -0.5 + gkNRuns, AliReducedVarManager::kRunID, 10, 0., 10., AliReducedVarManager::kNtracksAnalyzed, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(),"NPairsAnalyzed_RunNo_prof","",kTRUE, gkNRuns, -0.5, -0.5 + gkNRuns, AliReducedVarManager::kRunID, 10, 0., 10., AliReducedVarManager::kNpairsSelected, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      continue;
    }  // end if className contains "Event"

    // Track histograms
    if(classStr.Contains("TrackITSclusterMap_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;
       man->AddHistogram(classStr.Data(), "ITSlayerHit", "Hits in the ITS layers", kFALSE,
                         6, 0.5, 6.5, AliReducedVarManager::kITSlayerHit);
       if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "ITSlayerHit_Phi", "Hits in the ITS layers vs #varphi", kFALSE,
                           180, 0.0, 6.29, AliReducedVarManager::kPhi, 6, 0.5, 6.5, AliReducedVarManager::kITSlayerHit);
         man->AddHistogram(classStr.Data(), "ITSlayerHit_Eta", "Hits in the ITS layers vs #eta", kFALSE,
                           100, -1.0, 1.0, AliReducedVarManager::kEta, 6, 0.5, 6.5, AliReducedVarManager::kITSlayerHit);
       }
       continue;
    }  // end of ITSclusterMap histogram definitions

    if(classStr.Contains("TrackITSsharedClusterMap_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;
       man->AddHistogram(classStr.Data(), "ITSlayerShared", "Shared cls in the ITS layers", kFALSE,
                         6, 0.5, 6.5, AliReducedVarManager::kITSlayerShared);
       if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "ITSlayerShared_Phi", "Shared cls in the ITS layers vs #varphi", kFALSE,
                           180, 0.0, 6.29, AliReducedVarManager::kPhi, 6, 0.5, 6.5, AliReducedVarManager::kITSlayerShared);
         man->AddHistogram(classStr.Data(), "ITSlayerShared_Eta", "Shared cls in the ITS layers vs #eta", kFALSE,
                           100, -1.0, 1.0, AliReducedVarManager::kEta, 6, 0.5, 6.5, AliReducedVarManager::kITSlayerShared);
       }
       continue;
    }  // end of ITSclusterMap histogram definitions

    if(classStr.Contains("TrackTPCclusterMap_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;
       man->AddHistogram(classStr.Data(), "TPCclusterMap", "TPC cluster map", kFALSE,
                         8, -0.5, 7.5, AliReducedVarManager::kTPCclusBitFired);
       if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "TPCclusterMap_Phi", "TPC cluster map vs #varphi", kFALSE,
                           180, 0.0, 6.29, AliReducedVarManager::kPhi, 8, -0.5, 7.5, AliReducedVarManager::kTPCclusBitFired);
         man->AddHistogram(classStr.Data(), "TPCclusterMap_Eta", "TPC cluster map vs #eta", kFALSE,
                           100, -1.0, 1.0, AliReducedVarManager::kEta, 8, -0.5, 7.5, AliReducedVarManager::kTPCclusBitFired);
         man->AddHistogram(classStr.Data(), "TPCclusterMap_Pt", "TPC cluster map vs p_{T}", kFALSE,
                           100, 0.0, 10.0, AliReducedVarManager::kPt, 8, -0.5, 7.5, AliReducedVarManager::kTPCclusBitFired);
       }
       continue;
    }  // end of TPCclusterMap histogram definitions

    TString trkStatusNames = "";
    for(Int_t iflag=0; iflag<AliReducedVarManager::kNTrackingStatus; ++iflag) {
       trkStatusNames += AliReducedVarManager::fgkTrackingStatusNames[iflag];
       trkStatusNames += ";";
    }
    if(classStr.Contains("TrackStatusFlags_")) {
       man->AddHistClass(classStr.Data());
       cout << classStr.Data() << endl;
       man->AddHistogram(classStr.Data(), "TrackingFlags", "Tracking flags;;", kFALSE,
                         AliReducedVarManager::kNTrackingStatus, -0.5, AliReducedVarManager::kNTrackingStatus-0.5, AliReducedVarManager::kTrackingFlag,
                         0, 0.0, 0.0, AliReducedVarManager::kNothing, 0, 0.0, 0.0, AliReducedVarManager::kNothing, trkStatusNames.Data());
       continue;
    }

    if(classStr.Contains("Track_")) {
      man->AddHistClass(classStr.Data());
      cout << classStr.Data() << endl;

      //man->AddHistogram(classStr.Data(), "P_Pin", "P vs Pin", kFALSE, 100, 0.0, 10.0, AliReducedVarManager::kP, 100, 0.0, 10.0, AliReducedVarManager::kPin);
      man->AddHistogram(classStr.Data(), "Pt", "p_{T} distribution", kFALSE, 200, 0.0, 50.0, AliReducedVarManager::kPt);
      man->AddHistogram(classStr.Data(), "Pt_RunNo_QA", "<p_{T}> vs run number", kTRUE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        1000, 0.0, 50.0,                              AliReducedVarManager::kPt,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());

      man->AddHistogram(classStr.Data(), "P", "p distribution", kFALSE, 500, 0.0, 50.0, AliReducedVarManager::kP);
      man->AddHistogram(classStr.Data(), "Pin", "p_{IN} distribution", kFALSE, 200, 0.0, 50.0, AliReducedVarManager::kPin);
      man->AddHistogram(classStr.Data(), "Eta", "", kFALSE, 100, -1.0, 1.0, AliReducedVarManager::kEta);
      man->AddHistogram(classStr.Data(), "Eta_RunNo_QA", "<#eta> vs run number", kTRUE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        1000, -1.5, 1.5,                              AliReducedVarManager::kEta,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "Eta_Phi", "", kFALSE, 40, -1.0, 1.0, AliReducedVarManager::kEta, 36, 0., 6.29, AliReducedVarManager::kPhi);
         man->AddHistogram(classStr.Data(), "Eta_P", "", kFALSE, 40, -1.0, 1.0, AliReducedVarManager::kEta, 50, 0., 5.0, AliReducedVarManager::kP);
      }
      man->AddHistogram(classStr.Data(), "Phi", "", kFALSE, 36, 0.0, 6.29, AliReducedVarManager::kPhi);
      man->AddHistogram(classStr.Data(), "Phi_RunNo_QA", "<#varphi> vs run number", kTRUE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        1000, 0.0, 6.3,                               AliReducedVarManager::kPhi,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());

      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "DCAxy_Pt", "DCAxy", kFALSE, 100, -1.0, 1.0, AliReducedVarManager::kDcaXY, 50, 0.0, 10.0, AliReducedVarManager::kPt);
         man->AddHistogram(classStr.Data(), "DCAxy_DCAz", "DCAxy_DCAz", kFALSE, 200, -1.0, 1.0, AliReducedVarManager::kDcaXY, 200, -3.0, 3.0, AliReducedVarManager::kDcaZ);
      }
      man->AddHistogram(classStr.Data(), "DCAxy", "DCAxy", kFALSE, 1000, -2.5, 2.5, AliReducedVarManager::kDcaXY);
      if(classStr.Contains("Standard"))
         man->AddHistogram(classStr.Data(), "DCAxy_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kDcaXY, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      man->AddHistogram(classStr.Data(), "DCAz", "DCAz", kFALSE, 1000, -5.0, 5.0, AliReducedVarManager::kDcaZ);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "DCAz_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kDcaZ, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(), "DCAz_Pt", "DCAz", kFALSE, 100, -3.0, 3.0, AliReducedVarManager::kDcaZ, 50, 0.0, 10.0, AliReducedVarManager::kPt);
         man->AddHistogram(classStr.Data(), "DCAxy_goldenChi2", "DCAxy vs golden chi2", kFALSE, 100, -1.0, 1.0, AliReducedVarManager::kDcaXY, 200, 0.0, 1000.0, AliReducedVarManager::kChi2TPCConstrainedVsGlobal);
         man->AddHistogram(classStr.Data(), "DCAz_goldenChi2", "DCAz vs golden chi2", kFALSE, 100, -1.0, 1.0, AliReducedVarManager::kDcaZ, 200, 0.0, 1000.0, AliReducedVarManager::kChi2TPCConstrainedVsGlobal);
      }

      man->AddHistogram(classStr.Data(),"ITSncls", "ITS nclusters", kFALSE, 7,-0.5,6.5,AliReducedVarManager::kITSncls);
      if(classStr.Contains("Standard")){
         man->AddHistogram(classStr.Data(), "ITSncls_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kITSncls, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(), "ITSclsLayer1_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kITSnClusters+0, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());

       }
      man->AddHistogram(classStr.Data(),"ITSnclsShared", "ITS nclusters shared", kFALSE, 7,-0.5,6.5,AliReducedVarManager::kITSnclsShared);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "ITSnclsShared_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kITSnclsShared, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(),"Eta_Phi_ITSncls_prof","ITS <nclusters> vs (#eta,#phi)",kTRUE,
                   36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 7, -0.5, 6.5, AliReducedVarManager::kITSncls);
         man->AddHistogram(classStr.Data(),"Eta_Phi_ITSnclsShared_prof","ITS <nclusters-shared> vs (#eta,#phi)",kTRUE,
                        36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 7, -0.5, 6.5, AliReducedVarManager::kITSnclsShared);
      }
      man->AddHistogram(classStr.Data(),"ITSchi2", "ITS #chi^{2}", kFALSE, 200,0.0,50.0, AliReducedVarManager::kITSchi2);
      //man->AddHistogram(classStr.Data(),"ITSchi2_RunID_prof","",kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 10, 0., 10., AliReducedVarManager::kITSchi2);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"ITSchi2_ITSncls", "ITS #chi^{2} vs ITS clusters", kFALSE, 100,0.0,20.0, AliReducedVarManager::kITSchi2,7,-0.5,6.5, AliReducedVarManager::kITSncls);
         /*man->AddHistogram(classStr.Data(),"Eta_Phi_ITSchi2_prof","ITS <#chi^{2}> vs (#eta,#phi)",kTRUE,
                        36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 100, 0.0, 1000, AliReducedVarManager::kITSchi2);        */
         man->AddHistogram(classStr.Data(),"ITSchi2_NTracksTPCout_prof","",kTRUE,30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 10, 0., 10., AliReducedVarManager::kITSchi2);
      }
      man->AddHistogram(classStr.Data(),"Chi2TPCConstrainedVsGlobal","",kFALSE,1000,0.,200.,AliReducedVarManager::kChi2TPCConstrainedVsGlobal);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"Chi2TPCConstrainedVsGlobal_NTracksTPCout_prof","",kTRUE,30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout,1000,0.,200.,AliReducedVarManager::kChi2TPCConstrainedVsGlobal);
         man->AddHistogram(classStr.Data(), "Chi2TPCConstrainedVsGlobal_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kChi2TPCConstrainedVsGlobal, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
      }

      man->AddHistogram(classStr.Data(),"TPCncls","",kFALSE,160,-0.5,159.5,AliReducedVarManager::kTPCncls);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"TPCncls_RunID_prof","",kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 10, 0., 10., AliReducedVarManager::kTPCncls, 0, 0.,0.,AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(),"TPCncls_NTracksTPCout_prof","",kTRUE,30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 10, 0., 10., AliReducedVarManager::kTPCncls);
      }
      man->AddHistogram(classStr.Data(),"TPCcrossedRows","", kFALSE, 160,-0.5,159.5,AliReducedVarManager::kTPCcrossedRows);
      man->AddHistogram(classStr.Data(),"TPCfindableClusters","", kFALSE, 160,-0.5,159.5,AliReducedVarManager::kTPCnclsF);
      man->AddHistogram(classStr.Data(),"TPCcrossedRowsOverFindableClusters","", kFALSE, 200,0.0,1.5,AliReducedVarManager::kTPCcrossedRowsOverFindableClusters);
      man->AddHistogram(classStr.Data(),"TPCnclsShared","",kFALSE, 160,-0.5,159.5,AliReducedVarManager::kTPCnclsShared);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"TPCnclsShared_NTracksTPCout_prof","",kTRUE, 30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout,160,-0.5,159.5,AliReducedVarManager::kTPCnclsShared);
      }
      man->AddHistogram(classStr.Data(),"TPCnclsSharedRatio","",kFALSE, 200,0.,1.,AliReducedVarManager::kTPCnclsSharedRatio);

      man->AddHistogram(classStr.Data(),"TPCchi2","",kFALSE, 200,0.0,10.0,AliReducedVarManager::kTPCchi2);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"TPCchi2_NTracksTPCout_prof","",kTRUE, 30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout,10,0.0,10.,AliReducedVarManager::kTPCchi2);
         man->AddHistogram(classStr.Data(), "TPCchi2_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kTPCchi2, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(),"TPCchi2_Pt","",kFALSE, 200,0.0,10.0,AliReducedVarManager::kTPCchi2, 100, 0., 10.0, AliReducedVarManager::kPt);
         man->AddHistogram(classStr.Data(),"TPCchi2_TPCncls", "TPC #chi^{2} vs TPC clusters", kFALSE, 100,0.0,10.0, AliReducedVarManager::kTPCchi2,160,0.,160., AliReducedVarManager::kTPCncls);
         /*man->AddHistogram(classStr.Data(),"TPCchi2_CentVZERO", "TPC #chi^{2} vs CentVZERO", kFALSE, 100,0.0,10.0, AliReducedVarManager::kTPCchi2,20,0.,100., AliReducedVarManager::kCentVZERO);*/
         man->AddHistogram(classStr.Data(),"Eta_TPCchi2","TPC #chi^{2} vs #eta",kFALSE,
                        36, -0.9, 0.9, AliReducedVarManager::kEta, 100, 0.0, 10., AliReducedVarManager::kTPCchi2);
      }
      man->AddHistogram(classStr.Data(),"TPCsegments","",kFALSE, 9,0.0,9.0,AliReducedVarManager::kTPCNclusBitsFired);

      /*man->AddHistogram(classStr.Data(),"Eta_Phi_TPCncls_prof","TPC <nclusters> vs (#eta,#phi)",kTRUE,
       *             36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 160, -0.5, 159.5, AliReducedVarManager::kTPCncls);
       m an->Ad*dHistogram(classStr.Data(),"Eta_Phi_TPCcrossedRows_prof","TPC <n crossed rows> vs (#eta,#phi)",kTRUE,
       36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 160, -0.5, 159.5, AliReducedVarManager::kTPCcrossedRows);
       man->AddHistogram(classStr.Data(),"Eta_Phi_TPCnclsF_prof","TPC <nclusters findable> vs (#eta,#phi)",kTRUE,
       36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 160, -0.5, 159.5, AliReducedVarManager::kTPCnclsF);*/
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"Eta_Phi_TPCchi2_prof","TPC <#chi^{2}> vs (#eta,#phi)",kTRUE,
                           36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 160, -0.5, 159.5, AliReducedVarManager::kTPCchi2);
      }

      /*man->AddHistogram(classStr.Data(),"TPCchi2_NTracksTPCout_VZEROmult_prof","",kTRUE,20,0.,15000.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout, 20, 0., 30000., AliReducedVarManager::kVZEROTotalMult, 10, 0., 10., AliReducedVarManager::kTPCchi2);*/
      /*man->AddHistogram(classStr.Data(),"Eta_Phi_TPCchi2","TPC #chi^{2} vs (#eta,#phi)",kFALSE,
       *                  36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 100, 0., 10.0, AliReducedVarManager::kTPCchi2); */
      man->AddHistogram(classStr.Data(),"TPCsignal_Pin","TPC dE/dx vs. inner param P",kFALSE,
                        100,0.0,10.0,AliReducedVarManager::kPin,100,49.5,150.5,AliReducedVarManager::kTPCsignal);
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(),"TPCsignal_NTracksTPCout_prof","",kTRUE, 30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout,160,49.5,150.5,AliReducedVarManager::kTPCsignal);
      }
      man->AddHistogram(classStr.Data(),"TPCsignalN","",kFALSE,160,-0.5,159.5,AliReducedVarManager::kTPCsignalN);
      /*man->AddHistogram(classStr.Data(),"Eta_Phi_TPCsignalN_prof","TPC <nclusters pid> vs (#eta,#phi)",kTRUE,
       *             36, -0.9, 0.9, AliReducedVarManager::kEta, 90, 0.0, 2.0*TMath::Pi(), AliReducedVarManager::kPhi, 160, -0.5, 159.5, AliReducedVarManager::kTPCsignalN);    */
      man->AddHistogram(classStr.Data(),"TPCnsigElectron_Pin","TPC N_{#sigma} electron vs. inner param P",kFALSE,
                        300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
      man->AddHistogram(classStr.Data(), "TPCnsigElectron_Pin_Profile", "TPC N_{#sigma} electron vs. inner param P", kTRUE,
                        300, 0.0, 30.0,                               AliReducedVarManager::kPin,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);

        /*
        man->AddHistogram(classStr.Data(),"TPCnsigElectron_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                          300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
        man->AddHistogram(classStr.Data(),"TPCnsigProton_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                          300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton);
        man->AddHistogram(classStr.Data(),"TPCnsigPion_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                          300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion);
        */
      //TPCnSigma QA plots
      if(classStr.Contains("Standard")) {
         man->AddHistogram(classStr.Data(), "TPCnsigElectron_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(), "TPCnsigProton_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());
         man->AddHistogram(classStr.Data(), "TPCnsigPion_vs_Run_prof", "", kTRUE, gkNRuns, -0.5, -0.5+gkNRuns, AliReducedVarManager::kRunID, 300, 0., 300., AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion, 0, 0., 0., AliReducedVarManager::kNothing, gRunList.Data());

         man->AddHistogram(classStr.Data(),"TPCnsigElectron_NTracksTPCout_prof","",kTRUE, 30,0.,1500.,AliReducedVarManager::kNTracksPerTrackingStatus+AliReducedVarManager::kTPCout,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
         
          
        if (gIsCalibrated){
            man->AddHistogram(classStr.Data(), "TPCnsigElectronComb_Run", "TPC N_{#sigma} electron combined vs. run", kTRUE,
                        gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron,
                        0, 0, 0,                                      AliReducedVarManager::kNothing,
                        gRunList.Data());
            man->AddHistogram(classStr.Data(), "TPCnsigProtonComb_Run", "TPC N_{#sigma} electron combined vs. run", kTRUE,
                          gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                          100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton,
                          0, 0, 0,                                      AliReducedVarManager::kNothing,
                          gRunList.Data());
            man->AddHistogram(classStr.Data(), "TPCnsigPionComb_Run", "TPC N_{#sigma} electron combined vs. run", kTRUE,
                          gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                          100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion,
                          0, 0, 0,                                      AliReducedVarManager::kNothing,
                          gRunList.Data());
           man->AddHistogram(classStr.Data(),"TPCnsigElectronCombined_Pin","TPC N_{#sigma} electron combined vs. inner param P",kFALSE,
                          300,0.0,30.0,                               AliReducedVarManager::kPin,
                          100,-5.0,5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
          man->AddHistogram(classStr.Data(), "TPCnsigElectronCombined_Pin_Profile", "TPC N_{#sigma} electron combined vs. inner param P", kTRUE,
                        300, 0.0, 30.0,                               AliReducedVarManager::kPin,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
           /*
            man->AddHistogram(classStr.Data(),"TPCnsigElectronCombined_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                              300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
            man->AddHistogram(classStr.Data(),"TPCnsigProtonCombined_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                              300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton);
            man->AddHistogram(classStr.Data(),"TPCnsigPionCombined_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                              300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion);
            */
          }
          else {
            man->AddHistogram(classStr.Data(), "TPCnsigElectronComb_Run", "TPC N_{#sigma} electron combined vs. run", kTRUE,
                            gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                            100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron,
                            0, 0, 0,                                      AliReducedVarManager::kNothing,
                            gRunList.Data());
            man->AddHistogram(classStr.Data(), "TPCnsigProtonComb_Run", "TPC N_{#sigma} electron combined vs. run", kTRUE,
                                    gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                                    100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton,
                                    0, 0, 0,                                      AliReducedVarManager::kNothing,
                                    gRunList.Data());
            man->AddHistogram(classStr.Data(), "TPCnsigPionComb_Run", "TPC N_{#sigma} electron combined vs. run", kTRUE,
                                    gkNRuns, -0.5, -0.5+gkNRuns,   AliReducedVarManager::kRunID,
                                    100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion,
                                    0, 0, 0,                                      AliReducedVarManager::kNothing,
                                    gRunList.Data());
            man->AddHistogram(classStr.Data(), "TPCnsigElectronCombined_Pin", "TPC N_{#sigma} electron combined vs. inner param P", kFALSE,
                        300, 0.0, 30.0,                               AliReducedVarManager::kPin,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
            man->AddHistogram(classStr.Data(), "TPCnsigElectronCombined_Pin_Profile", "TPC N_{#sigma} electron combined vs. inner param P", kTRUE,
                        300, 0.0, 30.0,                               AliReducedVarManager::kPin,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
              /*
              man->AddHistogram(classStr.Data(),"TPCnsigElectronCombined_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                                300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
              man->AddHistogram(classStr.Data(),"TPCnsigProtonCombined_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                                300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kProton);
              man->AddHistogram(classStr.Data(),"TPCnsigPionCombined_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                                300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kPion);
              */
          }
      }
      man->AddHistogram(classStr.Data(),"TPCnsigElectron_Eta","TPC N_{#sigma} electron vs. #eta",kFALSE,
                        36,-0.9,0.9,AliReducedVarManager::kEta,100,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
      man->AddHistogram(classStr.Data(), "TPCnsigElectron_Eta_Profile", "TPC N_{#sigma} electron  vs. #eta", kTRUE,
                                        36, -0.9, 0.9,                                AliReducedVarManager::kEta,
                                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
      man->AddHistogram(classStr.Data(),"TPCnsigElectronCorrected_Pin","TPC N_{#sigma} electron corrected vs. inner param P",kFALSE,
                        300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
     man->AddHistogram(classStr.Data(), "TPCnsigElectronCorrected_Pin_Profile", "TPC N_{#sigma} electron corrected vs. inner param P", kTRUE,
                                      300, 0.0, 30.0,                               AliReducedVarManager::kPin,
                                      100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
      man->AddHistogram(classStr.Data(),"TPCnsigElectronCorrected_Eta","TPC N_{#sigma} electron corrected vs. #eta",kFALSE,
                        36,-0.9,0.9,AliReducedVarManager::kEta,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
      man->AddHistogram(classStr.Data(), "TPCnsigElectronCorrected_Eta_Profile", "TPC N_{#sigma} electron corrected vs. #eta", kTRUE,
                        36, -0.9, 0.9,                                AliReducedVarManager::kEta,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
        /*
        man->AddHistogram(classStr.Data(),"TPCnsigElectronCorrected_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                          300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
        man->AddHistogram(classStr.Data(),"TPCnsigProtonCorrected_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                          300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kProton);
        man->AddHistogram(classStr.Data(),"TPCnsigPionCorrected_Eta_Pin","TPC N_{#sigma} electron vs. eta vs. inner param P",kFALSE,36,-0.9,0.9,AliReducedVarManager::kEta,
                          300,0.0,30.0,AliReducedVarManager::kPin,100,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kPion); */

      const Int_t kTPCnsigmaNbins = 40;
      Double_t tpcNsigmaBinLims[kTPCnsigmaNbins+1];
      for(Int_t i=0; i<=kTPCnsigmaNbins;++i)
       tpcNsigmaBinLims[i] = -4.0+0.2*i;
       
      const Int_t kPinEleNbins = 13;
      Double_t pinEleBinLims[kPinEleNbins+1] = {
           0.8, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 2.0, 3.0, 4.0, 5.0, 7.0, 10.0, 20.0
      };
        
      const Int_t kEtaNbins = 9;
      Double_t etaBinLims[kEtaNbins+1] = {
         -0.9, -0.7, -0.5, -0.3, -0.1,
         0.1,  0.3,  0.5,  0.7,  0.9
      };
        
       const Int_t kNvarsPID = 3;
        Int_t varsPIDnSigEle[kNvarsPID] = {
              AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron, AliReducedVarManager::kPin, AliReducedVarManager::kEta
        };
        Int_t varsPIDnSigEleCorr[kNvarsPID] = {
                AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron, AliReducedVarManager::kPin, AliReducedVarManager::kEta
        };
        
       TArrayD nSigBinLimits[kNvarsPID];
         nSigBinLimits[0] = TArrayD(kTPCnsigmaNbins+1, tpcNsigmaBinLims);
         nSigBinLimits[1] = TArrayD(kPinEleNbins+1, pinEleBinLims);
         nSigBinLimits[2] = TArrayD(kEtaNbins+1, etaBinLims);

      man->AddHistogram(classStr.Data(), "nSigmaTPCelectron", "TPC n_{#sigma}(e)", kNvarsPID, varsPIDnSigEle, nSigBinLimits);
      man->AddHistogram(classStr.Data(), "nSigmaTPCelectronCorrected", "TPC n_{#sigma}(e)", kNvarsPID, varsPIDnSigEleCorr, nSigBinLimits);
      if (gIsCalibrated)
            man->AddHistogram(classStr.Data(), "nSigmaTPCelectronCombined", "TPC n_{#sigma}(e)", kNvarsPID, varsPIDnSigEleCorr, nSigBinLimits);
      else man->AddHistogram(classStr.Data(), "nSigmaTPCelectronCombined", "TPC n_{#sigma}(e)", kNvarsPID, varsPIDnSigEle, nSigBinLimits);
        
      if(classStr.Contains("Standard")) {
        if (gIsCalibrated){
        man->AddHistogram(classStr.Data(),"TPCnsigElectronCombined_Eta","TPC N_{#sigma} electron combined vs. #eta",kFALSE,
                        36,-0.9,0.9,                                AliReducedVarManager::kEta,
                        100,-5.0,5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
        man->AddHistogram(classStr.Data(), "TPCnsigElectronCombined_Eta_Profile", "TPC N_{#sigma} electron combined vs. #eta", kTRUE,
                        36, -0.9, 0.9,                                AliReducedVarManager::kEta,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron);
        }
        else {
          man->AddHistogram(classStr.Data(), "TPCnsigElectronCombined_Eta", "TPC N_{#sigma} electron combined vs. #eta", kFALSE,
                        36, -0.9, 0.9,                                AliReducedVarManager::kEta,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
          man->AddHistogram(classStr.Data(), "TPCnsigElectronCombined_Eta_Profile", "TPC N_{#sigma} electron combined vs. #eta", kTRUE,
                        36, -0.9, 0.9,                                AliReducedVarManager::kEta,
                        100, -5.0, 5.0,                               AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron);
        }
      }


      /*man->AddHistogram(classStr.Data(),"TPCchi2_vs_TPCnsigElectron_Pin_prof","<TPC chi2> vs TPC N_{#sigma} electron and inner param P",kTRUE,
                        20,0.0,5.0,AliReducedVarManager::kPin,30,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron, 10, 0., 10., AliReducedVarManager::kTPCchi2);*/
      /*man->AddHistogram(classStr.Data(),"TPCchi2_vs_TPCnsigElectron_Pin","TPC chi2 vs TPC N_{#sigma} electron and inner param P",kFALSE,
                        20,0.0,5.0,AliReducedVarManager::kPin,30,-5.0,5.0,AliReducedVarManager::kTPCnSig+AliReducedVarManager::kElectron, 80, 0., 8., AliReducedVarManager::kTPCchi2);*/
      /*man->AddHistogram(classStr.Data(),"TPCchi2_vs_TPCnsigElectronCorrected_Pin_prof","<TPC chi2> vs TPC N_{#sigma} electron corrected and inner param P",kTRUE,
                        20,0.0,5.0,AliReducedVarManager::kPin,30,-5.0,5.0,AliReducedVarManager::kTPCnSigCorrected+AliReducedVarManager::kElectron, 10, 0., 10., AliReducedVarManager::kTPCchi2);*/
      if(classStr.Contains("Standard")) {

         man->AddHistogram(classStr.Data(),"TOFbeta_P","TOF #beta vs P",kFALSE,
                 100,0.0,10.0,AliReducedVarManager::kP, 110,0.0,1.1,AliReducedVarManager::kTOFbeta);
         man->AddHistogram(classStr.Data(),"TOFnSigEle_P","TOF nSigEle vs P",kFALSE,
                        100,0.0,10.0,AliReducedVarManager::kP, 100,-5.0,5.0,AliReducedVarManager::kTOFnSig+AliReducedVarManager::kElectron);
         man->AddHistogram(classStr.Data(),"TOFnSigProt_P","TOF nSigProton vs P",kFALSE,
                        100,0.0,10.0,AliReducedVarManager::kP, 100,-5.0,5.0,AliReducedVarManager::kTOFnSig+AliReducedVarManager::kProton);
         man->AddHistogram(classStr.Data(),"TOFmismatchProbab","TOF mismatch probability",kFALSE,
                        2,0.0,2.0,AliReducedVarManager::kTOFmismatchProbability);
      }

      //man->AddHistogram(classStr.Data(),"TPCchi2_ITSchi2","",kFALSE, 100,0.0,10.0,AliReducedVarManager::kTPCchi2, 100,0.0,40.0,AliReducedVarManager::kITSchi2);
      //man->AddHistogram(classStr.Data(),"ITSchi2_Chi2TPCconstrainedVsGlobal","",kFALSE, 500,0.0,1000.0,AliReducedVarManager::kChi2TPCConstrainedVsGlobal, 100,0.0,40.0,AliReducedVarManager::kITSchi2);
      //man->AddHistogram(classStr.Data(),"TPCchi2_Chi2TPCconstrainedVsGlobal","",kFALSE, 500,0.0,1000.0,AliReducedVarManager::kChi2TPCConstrainedVsGlobal, 100,0.0,10.0,AliReducedVarManager::kTPCchi2);


        if(classStr.Contains("TrueElectron")) {
          man->AddHistogram(classStr.Data(), "PtMC", "p_{T} MC", kFALSE, 150, 0., 15.0, AliReducedVarManager::kPtMC);
          //man->AddHistogram(classStr.Data(), "PtRec_PtMC", "p_{T} MC vs p_{T} reconstructed", kFALSE, 100, 0., 10.0, AliReducedVarManager::kPtMC, 100, 0., 10.0, AliReducedVarManager::kPt);
          man->AddHistogram(classStr.Data(), "PhiMC", "#varphi MC", kFALSE, 180, 0., 6.3, AliReducedVarManager::kPhiMC);
          //man->AddHistogram(classStr.Data(), "PhiRec_PhiMC", "#varphi MC vs #varphi reconstructed", kFALSE, 180, 0., 6.3, AliReducedVarManager::kPhiMC, 180, 0., 6.3, AliReducedVarManager::kPhi);
          man->AddHistogram(classStr.Data(), "EtaMC", "#eta MC", kFALSE, 100, -1.0, 1.0, AliReducedVarManager::kEtaMC);
          //man->AddHistogram(classStr.Data(), "EtaRec_EtaMC", "#eta MC vs #eta reconstructed", kFALSE, 100, -1.0, 1.0, AliReducedVarManager::kEtaMC, 100, -1.0, 1.0, AliReducedVarManager::kEta);
          //man->AddHistogram(classStr.Data(), "PDGcode0", "PDG code of the track", kFALSE, 12000, -6000., 6000.0, AliReducedVarManager::kPdgMC);
          //man->AddHistogram(classStr.Data(), "PDGcode1", "PDG code of the track's mother", kFALSE, 12000, -6000., 6000.0, AliReducedVarManager::kPdgMC+1);
          //man->AddHistogram(classStr.Data(), "PDGcode2", "PDG code of the track's grand-mother", kFALSE, 12000, -6000., 6000.0, AliReducedVarManager::kPdgMC+2);
          //man->AddHistogram(classStr.Data(), "PDGcode3", "PDG code of the track's grand-grand mother", kFALSE, 12000, -6000., 6000.0, AliReducedVarManager::kPdgMC+3);
        }
      continue;
    }  // end if "TrackQA"

      // Histograms for pairs
    if(classStr.Contains("Pair")) {
      man->AddHistClass(classStr.Data());
      cout << classStr.Data() << endl;

      man->AddHistogram(classStr.Data(), "PairInvMass", "Differential pair inv. mass", kNVars, vars, pairHistBinLimits);
      if(classStr.Contains("PairSE") || classStr.Contains("PairPrefilterSE")) {
        man->AddHistogram(classStr.Data(), "Pt_Mass", "Pt_Mass", kFALSE, gkNMassBins-1, gMassBins, AliReducedVarManager::kMass,
                      gkNPtBins2D-1,gPtLims2D, AliReducedVarManager::kPt);
        man->AddHistogram(classStr.Data(), "PairType", "Pair type", kFALSE, 4, -0.5, 3.5, AliReducedVarManager::kPairType);
	      man->AddHistogram(classStr.Data(), "Mass", "Invariant mass", kFALSE, gkNMassBins-1, gMassBins, AliReducedVarManager::kMass);
        man->AddHistogram(classStr.Data(), "MassWide", "Invariant mass", kFALSE, 300, 0.0, 12.0, AliReducedVarManager::kMass);
        man->AddHistogram(classStr.Data(), "Pt", "", kFALSE, 1000, 0.0, 10.0, AliReducedVarManager::kPt);
        man->AddHistogram(classStr.Data(), "Pt_coarse", "", kFALSE, 20, 0.0, 20.0, AliReducedVarManager::kPt);
        //man->AddHistogram(classStr.Data(), "Leg1Pt_Leg2Pt", "", kFALSE, 100, 0.0, 10.0, AliReducedVarManager::kPairLegPt,
        //                  100, 0.0, 10.0, AliReducedVarManager::kPairLegPt+126);
        //man->AddHistogram(classStr.Data(), "Leg1Pt_Leg2Pt_Mass", "", kFALSE, 100, 0.0, 10.0, AliReducedVarManager::kPairLegPt,
        //                  100, 0.0, 10.0, AliReducedVarManager::kPairLegPt+1, 25, 2.5, 3.5, AliReducedVarManager::kMass);

        //man->AddHistogram(classStr.Data(), "LegPtSum", "", kFALSE, 100, 0.0, 10.0, AliReducedVarManager::kPairLegPtSum);
        //man->AddHistogram(classStr.Data(), "LegPtSum_PairPt", "", kFALSE, 100, 0.0, 10.0, AliReducedVarManager::kPt,
        //                                                                  100, 0.0, 10.0, AliReducedVarManager::kPairLegPtSum);
        //man->AddHistogram(classStr.Data(), "LegPtSum_Mass", "", kFALSE, 100, 0.0, 10.0, AliReducedVarManager::kPairLegPtSum,
        //                  100, 0.0, 10.0, AliReducedVarManager::kMass);

	//man->AddHistogram(classStr.Data(), "Rapidity", "Rapidity", kFALSE, 240, -1.2, 1.2, AliReducedVarManager::kRap);
	//man->AddHistogram(classStr.Data(), "Phi", "Azimuthal distribution", kFALSE, 315, 0.0, 6.3, AliReducedVarManager::kPhi);
      }   // end if "QA"

      if(classStr.Contains("TrueElectron")) {
         man->AddHistogram(classStr.Data(), "PtMC", "p_{T} MC", kFALSE, 200, 0., 10.0, AliReducedVarManager::kPtMC);
         man->AddHistogram(classStr.Data(), "PtMC_coarse", "p_{T} MC", kFALSE, 20, 0., 20.0, AliReducedVarManager::kPtMC);
         //man->AddHistogram(classStr.Data(), "MassMC_Mass", "Invariant mass, MC vs reconstructed", kFALSE, 150, 2.0, 3.5, AliReducedVarManager::kMass,
          //  150, 2.0, 3.5, AliReducedVarManager::kMassMC);
         //man->AddHistogram(classStr.Data(), "PtMC_Pt", "pair pT, MC vs reconstructed", kFALSE, 150, 0.0, 15., AliReducedVarManager::kPt,
          //                 150, 0.0, 15.0, AliReducedVarManager::kPtMC);
         /*man->AddHistogram(classStr.Data(), "PtMC_MassMC", "", kFALSE, 100, 0.0, 1., AliReducedVarManager::kPtMC,
                           30, 2.7, 3.3, AliReducedVarManager::kMassMC);
         man->AddHistogram(classStr.Data(), "Pt_Mass", "", kFALSE, 100, 0.0, 1., AliReducedVarManager::kPt,
                           30, 2.7, 3.3, AliReducedVarManager::kMass);
         man->AddHistogram(classStr.Data(), "PtMC_Mass", "", kFALSE, 100, 0.0, 1., AliReducedVarManager::kPtMC,
                           30, 2.7, 3.3, AliReducedVarManager::kMass);
         man->AddHistogram(classStr.Data(), "Pt_MassMC", "", kFALSE, 100, 0.0, 1., AliReducedVarManager::kPt,
                           30, 2.7, 3.3, AliReducedVarManager::kMassMC);  */
         //man->AddHistogram(classStr.Data(), "PtMC_Pt_lowPtZoom", "pair pT, MC vs reconstructed", kFALSE, 100, 0.0, 0.5, AliReducedVarManager::kPt,
          //                 100, 0.0, 0.5, AliReducedVarManager::kPtMC);
          //man->AddHistogram(classStr.Data(), "PtMC_Pt_Mass_coarse", "pair pT, MC vs reconstructed, vs mass", kFALSE, 25, 0.0, 0.5, AliReducedVarManager::kPt,
          //                25, 0.0, 0.5, AliReducedVarManager::kPtMC, 15, 2.72, 3.32, AliReducedVarManager::kMass);
          if(classStr.Contains("Standard")) {
            man->AddHistogram(classStr.Data(), "PtMC_Pt_Mass", "pair pT, MC vs reconstructed, vs mass", kFALSE, 200, 0.0, 20.0, AliReducedVarManager::kPt,
                              200, 0.0, 20.0, AliReducedVarManager::kPtMC, 15, 2.72, 3.32, AliReducedVarManager::kMass);
            man->AddHistogram(classStr.Data(), "CosThetaStarCS", "cos(#theta^{*})_{CS}", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaCS);
            man->AddHistogram(classStr.Data(), "CosThetaStarCS_pt_mass", "cos(#theta^{*})_{CS} vs reconstructed pt vs mass", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaCS, 400, 0., 20., AliReducedVarManager::kPt, 15, 2.72, 3.32, AliReducedVarManager::kMass);
            man->AddHistogram(classStr.Data(), "CosThetaStarHE", "cos(#theta^{*})_{HE}", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaHE);
            man->AddHistogram(classStr.Data(), "CosThetaStarHE_pt_mass", "cos(#theta^{*})_{HE} vs reconstructed pt vs mass", kFALSE, 88, -1.1, 1.1, AliReducedVarManager::kPairThetaHE, 400, 0., 20., AliReducedVarManager::kPt, 15, 2.72, 3.32, AliReducedVarManager::kMass);

          }
      }

      continue;
    }   // end if for Pair classes of histograms
  }  // end loop over histogram classes
}
