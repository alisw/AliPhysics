AliAnalysisTask *AddTaskEHCorrel(TString ContNameExt = "", Double_t centMin=0, Double_t centMax=20, Bool_t ClsTypeEMC=kTRUE, Bool_t ClsTypeDCAL=kTRUE, Int_t PhysSel = AliVEvent::kINT7, Int_t hadCutCase=2, Bool_t trigElePtcut=kFALSE)
{
  //get the current analysis manager
  AliAnalysisManager *mgr = AliAnalysisManager::GetAnalysisManager();
  if (!mgr) {
    Error("AddTaskHFEElecHadronCorrlPbPb", "No analysis manager found.");
    return 0;
  }

  if (!mgr->GetInputEventHandler()) {
    ::Error("AddTaskHFEElecHadronCorrlPbPb", "This task requires an input event handler");
    return NULL;
  }
  TString type = mgr->GetInputEventHandler()->GetDataType(); // can be "ESD" or "AOD"
  /*  if (type=="AOD"){
      ::Error("AddTaskHFEElecHadronCorrlPbPb", "The tasks exits because AODs are in input");
      return NULL;
      }
   */
  Bool_t MCthere=kTRUE;
  AliMCEventHandler *mcH = dynamic_cast<AliMCEventHandler*>(mgr->GetMCtruthEventHandler());
  if(!mcH){
    MCthere=kFALSE;
  }

  if(ClsTypeEMC && !ClsTypeDCAL)ContNameExt+="_EMC";
  if(!ClsTypeEMC && ClsTypeDCAL)ContNameExt+="_DCAL";

  if(PhysSel == AliVEvent::kINT7){
    AliAnalysisTaskEHCorrel *taskHFEeh = new AliAnalysisTaskEHCorrel("eh");
    taskHFEeh->SelectCollisionCandidates(AliVEvent::kINT7);
    taskHFEeh->SetCentralitySelection(centMin,centMax);
    taskHFEeh->SetHadronCutCase(hadCutCase);
    taskHFEeh->SetTriggerElePtCut(trigElePtcut);
    taskHFEeh->SetClusterTypeEMC(ClsTypeEMC);
    taskHFEeh->SetClusterTypeDCAL(ClsTypeDCAL);

    TString containerName = mgr->GetCommonFileName();
    TString SubcontainerName = ContNameExt;
    SubcontainerName += "_EHPbPb_INT7";
    AliAnalysisDataContainer *coutput3 = mgr->CreateContainer(SubcontainerName,TList::Class(),AliAnalysisManager::kOutputContainer,containerName.Data());

    mgr->ConnectInput(taskHFEeh,0,mgr->GetCommonInputContainer());
    mgr->ConnectOutput(taskHFEeh,1,coutput3);
    //mgr->AddTask(taskHFEeh);
  }

  if(PhysSel == AliVEvent::kEMCEGA){
    // EMCal EGA EG1
    AliAnalysisTaskEHCorrel *taskHFEehGA01 = new AliAnalysisTaskEHCorrel("ehGA");
    taskHFEehGA01->SelectCollisionCandidates(AliVEvent::kEMCEGA);
    taskHFEehGA01->SetEMCalTriggerEG1(kTRUE);
    taskHFEehGA01->SetCentralitySelection(centMin,centMax);
    taskHFEehGA01->SetHadronCutCase(hadCutCase);
    taskHFEehGA01->SetTriggerElePtCut(trigElePtcut);
    taskHFEehGA01->SetClusterTypeEMC(ClsTypeEMC);
    taskHFEehGA01->SetClusterTypeDCAL(ClsTypeDCAL);

    TString containerName01 = mgr->GetCommonFileName();
    TString SubcontainerName01 = ContNameExt;
    SubcontainerName01 += "_EH_PbPb_GA1";
    AliAnalysisDataContainer *cinput  = mgr->GetCommonInputContainer();
    AliAnalysisDataContainer *coutput1 = mgr->CreateContainer(SubcontainerName01, TList::Class(),AliAnalysisManager::kOutputContainer, containerName01.Data());

    mgr->ConnectInput(taskHFEehGA01, 0, cinput);
    mgr->ConnectOutput(taskHFEehGA01, 1, coutput1);
    //mgr->AddTask(taskHFEehGA01);
  }
  return taskHFEeh;
}
