*
* $Id$
*
* $Log$
* Revision 1.1.1.1  1996/04/01 15:03:25  mclareni
* Mathlib gen
*
*
#include "gen/pilot.h"
      SUBROUTINE TSTEXT (N,XEXTR,XLOW,XUP,EDGFAC,FRACT,NCUT,NCDIM,ICUT,D
     1ELPLS,DELNEG)
      INTEGER N, NCDIM, NCUT
      INTEGER ICUT(NCDIM)
      DOUBLE PRECISION EDGFAC, FRACT
      DOUBLE PRECISION XEXTR(N), XLOW(N), XUP(N), DELPLS(N), DELNEG(N)
      INTEGER I
      DOUBLE PRECISION DIFX
      NCUT=0
      DO 10 I=1,N
      DIFX=XUP(I)-XEXTR(I)
      DELPLS(I)=DIFX
      IF(DIFX.LT.EDGFAC*(XUP(I)-XLOW(I))) GOTO 10
      DELPLS(I)=FRACT*DIFX
      NCUT=NCUT+1
      ICUT(NCUT)=I
 10   CONTINUE
      DO 20 I=1,N
      DIFX=XEXTR(I)-XLOW(I)
      DELNEG(I)=DIFX
      IF(DIFX.LT.EDGFAC*(XUP(I)-XLOW(I))) GOTO 20
      DELNEG(I)=FRACT*DIFX
      NCUT=NCUT+1
      ICUT(NCUT)=-I
 20   CONTINUE
      RETURN
      END
