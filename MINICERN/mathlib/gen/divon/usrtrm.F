*
* $Id$
*
* $Log$
* Revision 1.1.1.1  1996/04/01 15:03:23  mclareni
* Mathlib gen
*
*
#include "gen/pilot.h"
      LOGICAL FUNCTION USRTRM(ITER)
      COMMON /ANSWER/ FINTGL,SPRD,DUMMY(5),NRGN,MAXRGN /FUNN/ NFUN,MO(2)
      COMMON /Z0001/ ERR,NMIN,MCOUNT /PRINT/ IPR /ZEETRM/ ITRMF
      INTEGER COUNT
      SAVE COUNT
      DATA FAC /1.0/
      DATA COUNT /0/
      USRTRM=.FALSE.
      IF(ITRMF.EQ.0) RETURN
      ERROR=ABS(ERR)
      IF(ERR.GT.0.0) ERROR=ERROR*FINTGL
      NPR=SPRD*FAC/ERROR+0.5
      IF(NPR.GT.1999) RETURN
      N=NFUN+NPR*NRGN
      IF(N.GE.NMIN) GOTO 10
      NMIN=N
      COUNT=0
      RETURN
 10   COUNT=COUNT+1
      IF(COUNT.GT.MCOUNT) USRTRM=.TRUE.
      IF(.NOT.(USRTRM).OR.IPR.LE.0) GOTO 30
      WRITE(6,20)
 20   FORMAT('0--- DIVON --- PARTITIONING TERMINATION.')
 30   RETURN
      END
