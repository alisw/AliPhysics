

AliAnalysisTaskJetCorePP* AddTaskJetCorePP(
   const Char_t* branchPrefix="clustersAOD",
   const Char_t* jetAlgo="ANTIKT",
   Float_t jetParameterR = 0.4,  //jet R 
   Int_t   bgMode = 0, 
   UInt_t  trkFilterMask = 272, 
   Float_t trackLowPtCut = 0.15,
   Int_t   skipJet = 0, 
   Int_t   collisionSystem = 0, //pp=0, pPb=1
   Int_t   offlineTriggerMask=AliVEvent::kMB, //MinBias=0 
   Int_t   minContribVtx = 1,
   Float_t vtxZMin = -10.0,
   Float_t vtxZMax = 10.0,
   Float_t centMin = 0.0,
   Float_t centMax = 100.0,
   Float_t triggerEtaCut = 0.9,
   Float_t trackEtaCut = 0.9,
   const Char_t* nonStdFile="",
   const Char_t* mcflag="",  // real="", MC2 = charged jets, MC = all jets  
   Int_t triggerType=0,  //0=single incl trigger, 1=leading track, 2=hadron pt>10 
   Int_t evtRangeLow=0,   //last digit of range of ESD event number
   Int_t evtRangeHigh=9,  //first digit of range of ESD event number
   Float_t trigRangeLow=0,  //trigger pT low bin boreder works with triggType=0
   Float_t trigRangeHigh=50  //trigger pT high border works with triggType=0
  ){ 

   Printf("adding task jet response\n");

   AliAnalysisManager *mgr = AliAnalysisManager::GetAnalysisManager();
   if(!mgr){
      ::Error("AddTaskJetCorePP", "No analysis manager to connect to.");
      return NULL;
   }
   if(!mgr->GetInputEventHandler()){
      ::Error("AddTaskJetCorePP", "This task requires an input event handler.");
      return NULL;
   }

   Float_t jetEtaMin = -0.9 + jetParameterR;
   Float_t jetEtaMax =  0.9 - jetParameterR; 
    
   TString analBranch(branchPrefix);
   TString stJetAlgo(jetAlgo);
   stJetAlgo.ToUpper();

 
   TString tail;
   tail = tail + "_" + stJetAlgo + Form("%02d",(Int_t) (10*jetParameterR));
   tail = tail + Form("_B%d",(Int_t) bgMode);
   tail = tail + Form("_Filter%05d",(UInt_t) trkFilterMask);
   tail = tail + Form("_Cut%05d",(Int_t) (1000*trackLowPtCut));

   if(analBranch.BeginsWith("clustersAOD"))
      tail = tail + Form("_Skip%02d",(Int_t) skipJet);
   
   analBranch = analBranch + tail; 
   //clustersAOD_ANTIKT04_B0_Filter00272_Cut00150_Skip00   
   //Skip00 none of the most energetic jets is ommited
   //Cut00150  pT min cut on track
   //Filter00272

   TString mcSuffix(mcflag);  //MC2= charged jets,  MC = all jets
   TString analBranchMC="";
   if(mcSuffix.Length()>0 && mcSuffix.Contains("MC")){
      analBranchMC = branchPrefix + mcSuffix + tail; 
   }

 
   AliAnalysisTaskJetCorePP *task = new AliAnalysisTaskJetCorePP(Form("JetCorePP_%s_%s_%d",analBranch.Data(), mcSuffix.Data(), offlineTriggerMask));

   task->SetBranchName(analBranch.Data());
   task->SetBranchNameMC(analBranchMC.Data());
   task->SetNonStdFile(nonStdFile);
   task->SetSystem(collisionSystem); 
   task->SetJetR(jetParameterR);
   task->SetOfflineTrgMask(offlineTriggerMask);
   task->SetMinContribVtx(minContribVtx);
   task->SetVtxZMin(vtxZMin);
   task->SetVtxZMax(vtxZMax);
   task->SetFilterMask(trkFilterMask);
   task->SetCentMin(centMin);
   task->SetCentMax(centMax);
   task->SetJetEtaMin(jetEtaMin);
   task->SetJetEtaMax(jetEtaMax);
   task->SetTriggerEtaCut(triggerEtaCut);
   task->SetTrackEtaCut(trackEtaCut);
   task->SetTrackLowPtCut(trackLowPtCut);
   task->SetTriggerType(triggerType); 
   task->SetEventNumberRangeLow(evtRangeLow);
   task->SetEventNumberRangeHigh(evtRangeHigh);
   task->SetTriggerPtRangeLow(trigRangeLow);
   task->SetTriggerPtRangeHigh(trigRangeHigh); 


   task->SetDebugLevel(0); //No debug messages 0
   mgr->AddTask(task);
   //E=  range of last two decimal numbers in event numbers
   //Ptt range of the cosidered trigger bin
   AliAnalysisDataContainer *coutputJetCorePP = mgr->CreateContainer(
      Form("pwgjejetcorepp_%s_%s_%d_T%d_E%d_%d_Ptt%.0f_%.0f",analBranch.Data(),mcSuffix.Data(),offlineTriggerMask,triggerType,evtRangeLow,evtRangeHigh,trigRangeLow,trigRangeHigh), 
      TList::Class(),
      AliAnalysisManager::kOutputContainer,
      Form("%s:PWGJE_jetcorepp_%s_%s_%d_T%d_E%d_%d_Ptt%.0f_%.0f",AliAnalysisManager::GetCommonFileName(),analBranch.Data(),mcSuffix.Data(),offlineTriggerMask,triggerType,evtRangeLow,evtRangeHigh,trigRangeLow,trigRangeHigh)
   );

   mgr->ConnectInput (task, 0, mgr->GetCommonInputContainer());
   mgr->ConnectOutput(task, 0, mgr->GetCommonOutputContainer());
   mgr->ConnectOutput(task, 1, coutputJetCorePP);

   return task;
}
