TH1* Get(TFile* f, const char* name)
{
  return  static_cast<TH1*>(f->Get(name)->Clone(Form("%s_clone")));
}

TH1* Fixup(TH1* h, TH1* scale, Color_t col, const char* title)
{
  if (scale) h->Multiply(scale);
  h->SetLineWidth(0);
  h->SetFillColor(col);
  h->SetFillStyle(3001);
  h->SetTitle(title);
  h->SetXTitle("#it{#eta}");
  h->SetYTitle("#it{N}_{ch,inclusive}(#it{#eta},#it{#varphi})");

  return h;
}

THStack* plotSecondaries(TH1* hPrim)
{
  gStyle->SetOptStat(0);
  TFile* secFile    = TFile::Open("secContributorHistos.root"); 
  TH1* hPrimaries   = Get(secFile, "hPrimaries");
  TH1* hEARLYDECAY  = Get(secFile, "hEARLYDECAY");
  TH1* hPIPE	    = Get(secFile, "hPIPE");
  TH1* hITS	    = Get(secFile, "hITS");
  TH1* hFMD	    = Get(secFile, "hFMD");
  TH1* hOTHER	    = Get(secFile, "hOTHER");
  TH1* hMCratio     = static_cast<TH1*>(hPrim->Clone("hMCratio"));
  hMCratio->Divide(hPrimaries);
                                   
  Fixup(hOTHER,	     hMCratio,	kCyan+2,    "Other");
  Fixup(hFMD,	     hMCratio,	kGreen+2,   "FMD");
  Fixup(hITS,        hMCratio,	kBlue+2,    "ITS");
  Fixup(hPIPE,	     hMCratio,	kRed+2,	    "Beam pipe");
  Fixup(hEARLYDECAY, hMCratio,	kMagenta+2, "Early decays");
  Fixup(hPrim,	     0,	        kGray,	    "Primary particles");	  

  TCanvas* c = new TCanvas("c", "C", 1200, 700);
  c->SetBorderSize(0);
  c->SetBorderMode(0);
  c->SetTopMargin(0.01);
  c->SetRightMargin(0.02);
  
  THStack* stack = new THStack("stack",
			       "dN_{ch}/d#eta Primary and Secondary Particles "
			       "- 0-5% central events");
  stack->Add(hPrim);
  stack->Add(hEARLYDECAY);
  stack->Add(hPIPE);
  stack->Add(hITS);
  stack->Add(hFMD);
  stack->Add(hOTHER);
  stack->Draw("hist");
  stack->GetHistogram()->SetXTitle("#it{#eta}");
  stack->GetHistogram()->SetYTitle(hFMD->GetYaxis()->GetTitle());
  // stack->GetYaxis()->SetRangeUser(750., stack->GetMaximum(""));
  stack->SetMinimum(hPrim->GetMinimum());
  stack->GetYaxis()->SetTitleOffset(1.35);
  // stack->GetXaxis()->SetRangeUser(-3.4, 4.9);

  TLegend* l = c->BuildLegend(0.3, 0.6, 0.55, 0.88);
  l->SetFillStyle(0);
  l->SetBorderSize(0);

  c->Print("PWGLF_Forward_analysis_note-secondary_origin.png");
  return stack;

}

void PlotdNdetaSec()
{

   TH1D *dndetaForward__1 = new TH1D("dndetaForward__1","ALICE Forward",200,-4,6);
   dndetaForward__1->SetBinContent(13,1467.985);
   dndetaForward__1->SetBinContent(14,1502.394);
   dndetaForward__1->SetBinContent(15,1468.229);
   dndetaForward__1->SetBinContent(16,1485.992);
   dndetaForward__1->SetBinContent(17,1489.985);
   dndetaForward__1->SetBinContent(18,1500.036);
   dndetaForward__1->SetBinContent(19,1507.571);
   dndetaForward__1->SetBinContent(20,1530.895);
   dndetaForward__1->SetBinContent(21,1558.04);
   dndetaForward__1->SetBinContent(22,1583.518);
   dndetaForward__1->SetBinContent(23,1600.189);
   dndetaForward__1->SetBinContent(24,1623.612);
   dndetaForward__1->SetBinContent(25,1638.474);
   dndetaForward__1->SetBinContent(26,1644.718);
   dndetaForward__1->SetBinContent(27,1659.811);
   dndetaForward__1->SetBinContent(28,1650.963);
   dndetaForward__1->SetBinContent(29,1669.849);
   dndetaForward__1->SetBinContent(30,1662.317);
   dndetaForward__1->SetBinContent(31,1683.657);
   dndetaForward__1->SetBinContent(32,1699.657);
   dndetaForward__1->SetBinContent(33,1736.292);
   dndetaForward__1->SetBinContent(34,1747.295);
   dndetaForward__1->SetBinContent(35,1772.494);
   dndetaForward__1->SetBinContent(36,1798.653);
   dndetaForward__1->SetBinContent(37,1812.545);
   dndetaForward__1->SetBinContent(38,1835.409);
   dndetaForward__1->SetBinContent(39,1846.501);
   dndetaForward__1->SetBinContent(40,1875.443);
   dndetaForward__1->SetBinContent(41,1864.746);
   dndetaForward__1->SetBinContent(42,1868.623);
   dndetaForward__1->SetBinContent(43,1868.945);
   dndetaForward__1->SetBinContent(44,1863.259);
   dndetaForward__1->SetBinContent(45,1867.294);

   dndetaForward__1->SetBinContent(46,1855.067);
   dndetaForward__1->SetBinContent(47,1847.927);
   dndetaForward__1->SetBinContent(48,1842.266);
   dndetaForward__1->SetBinContent(49,1848.742);
   dndetaForward__1->SetBinContent(50,1836.791);
   dndetaForward__1->SetBinContent(51,1833.646);
   dndetaForward__1->SetBinContent(52,1829.13);
   dndetaForward__1->SetBinContent(53,1818.386);
   dndetaForward__1->SetBinContent(54,1821.111);
   dndetaForward__1->SetBinContent(55,1815.35);
   dndetaForward__1->SetBinContent(56,1813.305);
   dndetaForward__1->SetBinContent(57,1799.218);
   dndetaForward__1->SetBinContent(58,1791.64);
   dndetaForward__1->SetBinContent(59,1782.269);
   dndetaForward__1->SetBinContent(60,1775.844);
   dndetaForward__1->SetBinContent(61,1756.292);
   dndetaForward__1->SetBinContent(62,1765.261);
   dndetaForward__1->SetBinContent(63,1746.903);
   dndetaForward__1->SetBinContent(64,1742.408);
   dndetaForward__1->SetBinContent(65,1736.637);
   dndetaForward__1->SetBinContent(66,1739.476);
   dndetaForward__1->SetBinContent(67,1721.417);
   dndetaForward__1->SetBinContent(68,1711.561);
   dndetaForward__1->SetBinContent(69,1708.152);
   dndetaForward__1->SetBinContent(70,1701.035);
   dndetaForward__1->SetBinContent(71,1688.588);
   dndetaForward__1->SetBinContent(72,1690.736);
   dndetaForward__1->SetBinContent(73,1678.654);
   dndetaForward__1->SetBinContent(74,1669.181);
   dndetaForward__1->SetBinContent(75,1668.093);
   dndetaForward__1->SetBinContent(76,1670.372);
   dndetaForward__1->SetBinContent(77,1656.24);
   dndetaForward__1->SetBinContent(78,1660.844);
   dndetaForward__1->SetBinContent(79,1676.596);
   dndetaForward__1->SetBinContent(80,1655.563);
   dndetaForward__1->SetBinContent(81,1641.857);
   dndetaForward__1->SetBinContent(82,1660.093);
   dndetaForward__1->SetBinContent(83,1655.999);
   dndetaForward__1->SetBinContent(84,1658.429);
   dndetaForward__1->SetBinContent(85,1662.753);
   dndetaForward__1->SetBinContent(86,1670.83);
   dndetaForward__1->SetBinContent(87,1672.965);
   dndetaForward__1->SetBinContent(88,1679.163);
   dndetaForward__1->SetBinContent(89,1687.461);
   dndetaForward__1->SetBinContent(90,1692.462);
   dndetaForward__1->SetBinContent(91,1703.1);
   dndetaForward__1->SetBinContent(92,1707.392);
   dndetaForward__1->SetBinContent(93,1717.308);
   dndetaForward__1->SetBinContent(94,1709.923);
   dndetaForward__1->SetBinContent(95,1725.118);
   dndetaForward__1->SetBinContent(96,1735.781);
   dndetaForward__1->SetBinContent(97,1742.903);
   dndetaForward__1->SetBinContent(98,1756.766);
   dndetaForward__1->SetBinContent(99,1750.247);
   dndetaForward__1->SetBinContent(100,1761.864);
   dndetaForward__1->SetBinContent(101,1773.648);
   dndetaForward__1->SetBinContent(102,1779.741);
   dndetaForward__1->SetBinContent(103,1785.516);
   dndetaForward__1->SetBinContent(104,1798.017);
   dndetaForward__1->SetBinContent(105,1797.568);
   dndetaForward__1->SetBinContent(106,1799.711);
   dndetaForward__1->SetBinContent(107,1805.549);
   dndetaForward__1->SetBinContent(108,1820.695);
   dndetaForward__1->SetBinContent(109,1814.358);
   dndetaForward__1->SetBinContent(110,1829.58);
   dndetaForward__1->SetBinContent(111,1834.583);
   dndetaForward__1->SetBinContent(112,1838.156);
   dndetaForward__1->SetBinContent(113,1837.153);
   dndetaForward__1->SetBinContent(114,1832.073);
   dndetaForward__1->SetBinContent(115,1832.448);

   dndetaForward__1->SetBinContent(116,1905.195);
   dndetaForward__1->SetBinContent(117,1899.246);
   dndetaForward__1->SetBinContent(118,1905.878);
   dndetaForward__1->SetBinContent(119,1919.389);
   dndetaForward__1->SetBinContent(120,1926.601);
   dndetaForward__1->SetBinContent(121,1917.361);
   dndetaForward__1->SetBinContent(122,1900.598);
   dndetaForward__1->SetBinContent(123,1873.442);
   dndetaForward__1->SetBinContent(124,1869.079);
   dndetaForward__1->SetBinContent(125,1825.269);
   dndetaForward__1->SetBinContent(126,1829.855);
   dndetaForward__1->SetBinContent(127,1798.04);
   dndetaForward__1->SetBinContent(128,1779.091);
   dndetaForward__1->SetBinContent(129,1777.594);
   dndetaForward__1->SetBinContent(130,1774.297);
   dndetaForward__1->SetBinContent(131,1772.702);
   dndetaForward__1->SetBinContent(132,1765.652);
   dndetaForward__1->SetBinContent(133,1743.118);
   dndetaForward__1->SetBinContent(134,1726.628);
   dndetaForward__1->SetBinContent(135,1705.065);
   dndetaForward__1->SetBinContent(136,1673.165);
   dndetaForward__1->SetBinContent(137,1651.684);
   dndetaForward__1->SetBinContent(138,1613.546);
   dndetaForward__1->SetBinContent(139,1585.012);
   dndetaForward__1->SetBinContent(140,1554.546);
   dndetaForward__1->SetBinContent(141,1516.937);
   dndetaForward__1->SetBinContent(142,1491.536);
   dndetaForward__1->SetBinContent(143,1478.963);
   dndetaForward__1->SetBinContent(144,1458.31);
   dndetaForward__1->SetBinContent(145,1441.828);
   dndetaForward__1->SetBinContent(146,1433.611);
   dndetaForward__1->SetBinContent(147,1422.567);
   dndetaForward__1->SetBinContent(148,1407.266);
   dndetaForward__1->SetBinContent(149,1413.008);
   dndetaForward__1->SetBinContent(150,1387.839);
   dndetaForward__1->SetBinContent(151,1383.319);
   dndetaForward__1->SetBinContent(152,1365.911);
   dndetaForward__1->SetBinContent(153,1368.665);
   dndetaForward__1->SetBinContent(154,1429.612);
   dndetaForward__1->SetBinContent(155,1424.003);
   dndetaForward__1->SetBinContent(156,1383.685);
   dndetaForward__1->SetBinContent(157,1366.415);
   dndetaForward__1->SetBinContent(158,1344.734);
   dndetaForward__1->SetBinContent(159,1325.07);
   dndetaForward__1->SetBinContent(160,1305.228);
   dndetaForward__1->SetBinContent(161,1275.633);
   dndetaForward__1->SetBinContent(162,1248.653);
   dndetaForward__1->SetBinContent(163,1223.677);
   dndetaForward__1->SetBinContent(164,1193.735);
   dndetaForward__1->SetBinContent(165,1176.246);
   dndetaForward__1->SetBinContent(166,1159.009);
   dndetaForward__1->SetBinContent(167,1132.984);
   dndetaForward__1->SetBinContent(168,1117.719);
   dndetaForward__1->SetBinContent(169,962.8479);
   dndetaForward__1->SetBinContent(170,1056.517);
   dndetaForward__1->SetBinContent(171,1032.795);
   dndetaForward__1->SetBinContent(172,1020.727);
   dndetaForward__1->SetBinContent(173,1008.97);
   dndetaForward__1->SetBinContent(174,984.8162);
   dndetaForward__1->SetBinContent(175,981.0471);
   dndetaForward__1->SetBinContent(176,959.2129);
   dndetaForward__1->SetBinContent(177,950.4695);
   dndetaForward__1->SetBinContent(178,921.6278);
   dndetaForward__1->SetBinContent(179,909.4138);
   dndetaForward__1->SetBinError(13,7.779825);
   dndetaForward__1->SetBinError(14,5.57727);
   dndetaForward__1->SetBinError(15,4.994757);
   dndetaForward__1->SetBinError(16,4.573271);
   dndetaForward__1->SetBinError(17,4.456298);
   dndetaForward__1->SetBinError(18,4.363806);
   dndetaForward__1->SetBinError(19,4.373031);
   dndetaForward__1->SetBinError(20,4.42475);
   dndetaForward__1->SetBinError(21,4.482782);
   dndetaForward__1->SetBinError(22,4.540196);
   dndetaForward__1->SetBinError(23,4.54767);
   dndetaForward__1->SetBinError(24,4.589042);
   dndetaForward__1->SetBinError(25,4.591705);
   dndetaForward__1->SetBinError(26,4.579631);
   dndetaForward__1->SetBinError(27,4.57145);
   dndetaForward__1->SetBinError(28,4.507628);
   dndetaForward__1->SetBinError(29,4.51489);
   dndetaForward__1->SetBinError(30,4.464639);
   dndetaForward__1->SetBinError(31,4.502839);
   dndetaForward__1->SetBinError(32,4.52114);
   dndetaForward__1->SetBinError(33,4.596589);
   dndetaForward__1->SetBinError(34,4.54081);
   dndetaForward__1->SetBinError(35,4.477885);
   dndetaForward__1->SetBinError(36,4.419306);
   dndetaForward__1->SetBinError(37,4.370827);
   dndetaForward__1->SetBinError(38,4.470607);
   dndetaForward__1->SetBinError(39,4.55731);
   dndetaForward__1->SetBinError(40,4.733173);
   dndetaForward__1->SetBinError(41,4.747053);
   dndetaForward__1->SetBinError(42,4.812747);
   dndetaForward__1->SetBinError(43,4.822988);
   dndetaForward__1->SetBinError(44,4.951722);
   dndetaForward__1->SetBinError(45,5.371321);

   dndetaForward__1->SetBinError(46,5.346128);
   dndetaForward__1->SetBinError(47,5.14908);
   dndetaForward__1->SetBinError(48,5.185771);
   dndetaForward__1->SetBinError(49,5.210923);
   dndetaForward__1->SetBinError(50,5.175311);
   dndetaForward__1->SetBinError(51,5.052102);
   dndetaForward__1->SetBinError(52,5.083811);
   dndetaForward__1->SetBinError(53,5.04838);
   dndetaForward__1->SetBinError(54,5.085695);
   dndetaForward__1->SetBinError(55,5.051523);
   dndetaForward__1->SetBinError(56,4.968328);
   dndetaForward__1->SetBinError(57,4.977091);
   dndetaForward__1->SetBinError(58,4.96361);
   dndetaForward__1->SetBinError(59,4.935201);
   dndetaForward__1->SetBinError(60,4.925864);
   dndetaForward__1->SetBinError(61,4.882756);
   dndetaForward__1->SetBinError(62,4.879518);
   dndetaForward__1->SetBinError(63,4.847831);
   dndetaForward__1->SetBinError(64,4.849216);
   dndetaForward__1->SetBinError(65,4.849871);
   dndetaForward__1->SetBinError(66,4.841557);
   dndetaForward__1->SetBinError(67,4.789233);
   dndetaForward__1->SetBinError(68,4.791591);
   dndetaForward__1->SetBinError(69,4.760757);
   dndetaForward__1->SetBinError(70,4.773497);
   dndetaForward__1->SetBinError(71,4.737444);
   dndetaForward__1->SetBinError(72,4.764147);
   dndetaForward__1->SetBinError(73,4.750428);
   dndetaForward__1->SetBinError(74,4.683524);
   dndetaForward__1->SetBinError(75,4.699434);
   dndetaForward__1->SetBinError(76,4.705691);
   dndetaForward__1->SetBinError(77,4.666883);
   dndetaForward__1->SetBinError(78,4.648289);
   dndetaForward__1->SetBinError(79,4.727235);
   dndetaForward__1->SetBinError(80,4.666632);
   dndetaForward__1->SetBinError(81,4.626514);
   dndetaForward__1->SetBinError(82,4.689344);
   dndetaForward__1->SetBinError(83,4.66388);
   dndetaForward__1->SetBinError(84,4.6599);
   dndetaForward__1->SetBinError(85,4.681642);
   dndetaForward__1->SetBinError(86,4.672207);
   dndetaForward__1->SetBinError(87,4.677014);
   dndetaForward__1->SetBinError(88,4.691059);
   dndetaForward__1->SetBinError(89,4.704336);
   dndetaForward__1->SetBinError(90,4.707473);
   dndetaForward__1->SetBinError(91,4.733671);
   dndetaForward__1->SetBinError(92,4.742519);
   dndetaForward__1->SetBinError(93,4.734488);
   dndetaForward__1->SetBinError(94,4.72185);
   dndetaForward__1->SetBinError(95,4.75083);
   dndetaForward__1->SetBinError(96,4.762763);
   dndetaForward__1->SetBinError(97,4.773598);
   dndetaForward__1->SetBinError(98,4.802178);
   dndetaForward__1->SetBinError(99,4.777342);
   dndetaForward__1->SetBinError(100,4.795552);
   dndetaForward__1->SetBinError(101,4.862764);
   dndetaForward__1->SetBinError(102,4.857414);
   dndetaForward__1->SetBinError(103,4.867396);
   dndetaForward__1->SetBinError(104,4.898757);
   dndetaForward__1->SetBinError(105,4.891234);
   dndetaForward__1->SetBinError(106,4.879341);
   dndetaForward__1->SetBinError(107,4.965344);
   dndetaForward__1->SetBinError(108,5.018235);
   dndetaForward__1->SetBinError(109,4.971481);
   dndetaForward__1->SetBinError(110,5.013026);
   dndetaForward__1->SetBinError(111,4.981103);
   dndetaForward__1->SetBinError(112,5.155675);
   dndetaForward__1->SetBinError(113,5.123857);
   dndetaForward__1->SetBinError(114,5.086489);
   dndetaForward__1->SetBinError(115,5.049245);

   dndetaForward__1->SetBinError(116,5.530439);
   dndetaForward__1->SetBinError(117,5.21808);
   dndetaForward__1->SetBinError(118,5.141581);
   dndetaForward__1->SetBinError(119,5.189076);
   dndetaForward__1->SetBinError(120,5.214923);
   dndetaForward__1->SetBinError(121,5.195063);
   dndetaForward__1->SetBinError(122,5.161009);
   dndetaForward__1->SetBinError(123,5.167622);
   dndetaForward__1->SetBinError(124,5.276355);
   dndetaForward__1->SetBinError(125,5.501907);
   dndetaForward__1->SetBinError(126,5.679112);
   dndetaForward__1->SetBinError(127,5.422619);
   dndetaForward__1->SetBinError(128,5.117376);
   dndetaForward__1->SetBinError(129,4.911031);
   dndetaForward__1->SetBinError(130,4.884726);
   dndetaForward__1->SetBinError(131,4.89433);
   dndetaForward__1->SetBinError(132,4.916502);
   dndetaForward__1->SetBinError(133,4.884697);
   dndetaForward__1->SetBinError(134,4.878176);
   dndetaForward__1->SetBinError(135,4.847151);
   dndetaForward__1->SetBinError(136,4.797073);
   dndetaForward__1->SetBinError(137,4.772952);
   dndetaForward__1->SetBinError(138,4.698318);
   dndetaForward__1->SetBinError(139,4.649452);
   dndetaForward__1->SetBinError(140,4.601431);
   dndetaForward__1->SetBinError(141,4.540488);
   dndetaForward__1->SetBinError(142,4.499159);
   dndetaForward__1->SetBinError(143,4.500838);
   dndetaForward__1->SetBinError(144,4.493606);
   dndetaForward__1->SetBinError(145,4.478067);
   dndetaForward__1->SetBinError(146,4.493529);
   dndetaForward__1->SetBinError(147,4.504826);
   dndetaForward__1->SetBinError(148,4.514835);
   dndetaForward__1->SetBinError(149,4.58933);
   dndetaForward__1->SetBinError(150,4.628405);
   dndetaForward__1->SetBinError(151,5.009202);
   dndetaForward__1->SetBinError(152,6.624392);
   dndetaForward__1->SetBinError(153,10.44422);
   dndetaForward__1->SetBinError(154,4.571599);
   dndetaForward__1->SetBinError(155,4.273844);
   dndetaForward__1->SetBinError(156,4.188925);
   dndetaForward__1->SetBinError(157,4.178995);
   dndetaForward__1->SetBinError(158,4.156171);
   dndetaForward__1->SetBinError(159,4.131165);
   dndetaForward__1->SetBinError(160,4.126364);
   dndetaForward__1->SetBinError(161,4.081851);
   dndetaForward__1->SetBinError(162,4.065089);
   dndetaForward__1->SetBinError(163,4.029861);
   dndetaForward__1->SetBinError(164,3.996054);
   dndetaForward__1->SetBinError(165,3.990943);
   dndetaForward__1->SetBinError(166,3.992891);
   dndetaForward__1->SetBinError(167,3.974532);
   dndetaForward__1->SetBinError(168,3.983048);
   dndetaForward__1->SetBinError(169,6.297124);
   dndetaForward__1->SetBinError(170,3.940285);
   dndetaForward__1->SetBinError(171,3.912542);
   dndetaForward__1->SetBinError(172,3.939947);
   dndetaForward__1->SetBinError(173,3.957036);
   dndetaForward__1->SetBinError(174,3.943891);
   dndetaForward__1->SetBinError(175,4.003377);
   dndetaForward__1->SetBinError(176,3.993493);
   dndetaForward__1->SetBinError(177,4.027127);
   dndetaForward__1->SetBinError(178,3.988145);
   dndetaForward__1->SetBinError(179,6.595887);
   dndetaForward__1->SetMinimum(471.5452);
   dndetaForward__1->SetMaximum(2009.527);
   dndetaForward__1->SetEntries(9734036);
   dndetaForward__1->SetDirectory(0);
   dndetaForward__1->SetStats(0);
//   dndetaForward__1->SetFillStyle(0);
//   dndetaForward__1->SetMarkerColor(4);
//   dndetaForward__1->SetMarkerStyle(20);
   dndetaForward__1->GetXaxis()->SetTitle("#eta");
   dndetaForward__1->GetXaxis()->SetNdivisions(10);
   dndetaForward__1->GetXaxis()->SetLabelFont(132);
   dndetaForward__1->GetXaxis()->SetTitleFont(132);
   dndetaForward__1->GetYaxis()->SetTitle("#frac{1}{N} #frac{dN_{ch}}{d#eta}");
   dndetaForward__1->GetYaxis()->SetNdivisions(10);
   dndetaForward__1->GetYaxis()->SetLabelFont(132);
   dndetaForward__1->GetYaxis()->SetTitleFont(132);

   plotSecondaries(dndetaForward__1);
}
